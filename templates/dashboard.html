<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Talazo AgriFinance - Professional Dashboard</title>

    <!-- External Libraries -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js@1.12.0/src/toastify.min.js"></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/toastify-js@1.12.0/src/toastify.min.css"
    />

    <style>
      /* Talazo AgriFinance - Professional Dashboard Styling */

      :root {
        /* Color Palette - Professional Financial Institution */
        --primary-color: #2d7d32; /* Forest Green */
        --primary-light: #4caf50; /* Light Green */
        --primary-dark: #1b5e20; /* Dark Green */
        --secondary-color: #ff8f00; /* Amber */
        --secondary-light: #ffb74d; /* Light Amber */
        --accent-color: #795548; /* Brown */
        --accent-light: #a1887f; /* Light Brown */

        /* Neutral Colors */
        --white: #ffffff;
        --off-white: #fafafa;
        --light-gray: #f5f5f5;
        --gray: #9e9e9e;
        --dark-gray: #424242;
        --charcoal: #212121;

        /* Financial Status Colors */
        --success: #4caf50;
        --warning: #ff9800;
        --error: #f44336;
        --info: #2196f3;
        --excellent: #0d7377;
        --good: #14a085;
        --fair: #f39c12;
        --poor: #e74c3c;

        /* Typography */
        --font-primary: "Inter", sans-serif;
        --font-display: "Playfair Display", serif;

        /* Spacing */
        --spacing-xs: 0.5rem;
        --spacing-sm: 1rem;
        --spacing-md: 1.5rem;
        --spacing-lg: 2rem;
        --spacing-xl: 3rem;
        --spacing-xxl: 4rem;

        /* Border Radius */
        --radius-sm: 6px;
        --radius-md: 10px;
        --radius-lg: 16px;
        --radius-xl: 24px;

        /* Shadows */
        --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.12);
        --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.15);
        --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.2);

        /* Transitions */
        --transition-fast: 0.2s ease;
        --transition-normal: 0.3s ease;
        --transition-slow: 0.5s ease;
      }

      /* Reset and Base Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: var(--font-primary);
        background: linear-gradient(
          135deg,
          #f8fffe 0%,
          #e8f5e8 50%,
          #f0f8f0 100%
        );
        color: var(--charcoal);
        line-height: 1.6;
        min-height: 100vh;
        padding-left: 280px; /* Account for sidebar */
        transition: padding-left var(--transition-normal);
        overflow-x: hidden;
      }

      body.sidebar-collapsed {
        padding-left: 80px;
      }

      body.mobile {
        padding-left: 0;
      }

      /* Sidebar Styles */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 280px;
        height: 100vh;
        background: linear-gradient(180deg, var(--charcoal) 0%, #1a1a1a 100%);
        color: var(--white);
        z-index: 1000;
        display: flex;
        flex-direction: column;
        transition: var(--transition-normal);
        box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .sidebar.collapsed {
        width: 80px;
      }

      .sidebar-header {
        padding: var(--spacing-lg);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        justify-content: space-between;
        min-height: 70px;
      }

      .sidebar-logo {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        transition: var(--transition-normal);
      }

      .sidebar-logo .logo-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        border-radius: var(--radius-lg);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--white);
        font-size: 1.25rem;
        box-shadow: var(--shadow-md);
        flex-shrink: 0;
      }

      .logo-text {
        font-family: var(--font-display);
        font-size: 1.25rem;
        font-weight: 600;
        white-space: nowrap;
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .logo-text {
        opacity: 0;
        width: 0;
      }

      .sidebar-toggle {
        background: none;
        border: none;
        color: var(--white);
        font-size: 1.25rem;
        cursor: pointer;
        padding: var(--spacing-sm);
        border-radius: var(--radius-md);
        transition: var(--transition-fast);
        opacity: 1;
      }

      .sidebar-toggle:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .sidebar.collapsed .sidebar-toggle {
        opacity: 0;
        pointer-events: none;
      }

      .sidebar-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow-y: auto;
        overflow-x: hidden;
      }

      .user-profile {
        padding: var(--spacing-lg);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        transition: var(--transition-normal);
      }

      .profile-avatar {
        font-size: 2.5rem;
        color: var(--primary-light);
        flex-shrink: 0;
      }

      .profile-info {
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .profile-info {
        opacity: 0;
        width: 0;
      }

      .profile-name {
        font-weight: 600;
        font-size: 1rem;
        color: var(--white);
        margin-bottom: var(--spacing-xs);
      }

      .profile-role {
        font-size: 0.875rem;
        color: rgba(255, 255, 255, 0.7);
      }

      .nav-menu {
        list-style: none;
        padding: var(--spacing-lg) 0;
        margin: 0;
        flex: 1;
      }

      .nav-item {
        margin-bottom: var(--spacing-xs);
        position: relative;
      }

      .nav-item.active .nav-link {
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        color: var(--white);
        box-shadow: var(--shadow-md);
      }

      .nav-item.active .nav-indicator {
        opacity: 1;
        transform: scaleY(1);
      }

      .nav-link {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        padding: var(--spacing-md) var(--spacing-lg);
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        transition: var(--transition-fast);
        border-radius: 0 25px 25px 0;
        margin-right: var(--spacing-md);
        position: relative;
        overflow: hidden;
      }

      .nav-link:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--white);
        transform: translateX(5px);
      }

      .nav-link i {
        font-size: 1.25rem;
        width: 24px;
        text-align: center;
        flex-shrink: 0;
      }

      .nav-text {
        font-weight: 500;
        white-space: nowrap;
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .nav-text {
        opacity: 0;
        width: 0;
      }

      .nav-badge {
        background: var(--primary-color);
        color: var(--white);
        font-size: 0.75rem;
        padding: 2px 6px;
        border-radius: var(--radius-sm);
        min-width: 20px;
        text-align: center;
        margin-left: auto;
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .nav-badge {
        opacity: 0;
        width: 0;
      }

      .nav-notification {
        width: 8px;
        height: 8px;
        background: var(--error);
        border-radius: 50%;
        margin-left: auto;
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .nav-notification {
        opacity: 0;
        width: 0;
      }

      .nav-indicator {
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%) scaleY(0);
        width: 4px;
        height: 100%;
        background: var(--primary-light);
        border-radius: 0 2px 2px 0;
        transition: var(--transition-fast);
        opacity: 0;
      }

      .nav-divider {
        height: 1px;
        background: rgba(255, 255, 255, 0.1);
        margin: var(--spacing-md) var(--spacing-lg);
      }

      .nav-section {
        padding: var(--spacing-md) var(--spacing-lg) var(--spacing-sm);
      }

      .nav-section-title {
        font-size: 0.75rem;
        color: rgba(255, 255, 255, 0.5);
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 600;
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .nav-section-title {
        opacity: 0;
      }

      .sidebar-footer {
        padding: var(--spacing-lg);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .quick-actions {
        display: flex;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
        justify-content: space-between;
      }

      .quick-action {
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: var(--white);
        width: 40px;
        height: 40px;
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: var(--transition-fast);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .quick-action:hover {
        background: var(--primary-color);
        transform: translateY(-2px);
      }

      .logout-btn {
        width: 100%;
        background: none;
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.8);
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: var(--transition-fast);
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        justify-content: center;
      }

      .logout-btn:hover {
        background: rgba(244, 67, 54, 0.2);
        border-color: var(--error);
        color: var(--white);
      }

      .sidebar.collapsed .logout-btn .nav-text {
        opacity: 0;
        width: 0;
      }

      /* Mobile Overlay */
      .sidebar-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition-normal);
      }

      .sidebar-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      /* Header */
      .header {
        background: var(--white);
        box-shadow: var(--shadow-sm);
        border-bottom: 1px solid rgba(45, 125, 50, 0.1);
        position: sticky;
        top: 0;
        z-index: 900;
        transition: var(--transition-normal);
      }

      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--spacing-md) var(--spacing-xl);
        gap: var(--spacing-lg);
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: var(--spacing-lg);
      }

      .mobile-menu-toggle {
        display: none;
        background: none;
        border: none;
        font-size: 1.25rem;
        color: var(--charcoal);
        cursor: pointer;
        padding: var(--spacing-sm);
        border-radius: var(--radius-md);
        transition: var(--transition-fast);
      }

      .mobile-menu-toggle:hover {
        background: var(--light-gray);
      }

      .breadcrumb {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        color: var(--gray);
        font-size: 0.875rem;
        font-weight: 500;
      }

      .breadcrumb i {
        color: var(--primary-color);
      }

      .breadcrumb .fas.fa-chevron-right {
        font-size: 0.75rem;
        color: var(--gray);
      }

      .header-actions {
        display: flex;
        gap: var(--spacing-md);
        align-items: center;
      }

      .farmer-selector {
        padding: var(--spacing-sm) var(--spacing-md);
        border: 2px solid rgba(45, 125, 50, 0.2);
        border-radius: var(--radius-md);
        background: var(--white);
        color: var(--charcoal);
        font-family: var(--font-primary);
        font-weight: 500;
        transition: var(--transition-fast);
        min-width: 200px;
      }

      .farmer-selector:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(45, 125, 50, 0.1);
      }

      .status-indicator {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: var(--radius-md);
        font-size: 0.875rem;
        font-weight: 500;
      }

      .status-indicator.online {
        background: rgba(76, 175, 80, 0.1);
        color: var(--success);
      }

      .status-pulse {
        width: 8px;
        height: 8px;
        background: var(--success);
        border-radius: 50%;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      /* Container */
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: var(--spacing-lg);
      }

      /* Dashboard Overview Cards */
      .overview-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-xl);
      }

      .overview-card {
        background: var(--white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow-md);
        border: 1px solid rgba(45, 125, 50, 0.1);
        transition: var(--transition-normal);
        position: relative;
        overflow: hidden;
      }

      .overview-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--primary-light)
        );
      }

      .overview-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: var(--spacing-md);
      }

      .card-icon {
        width: 60px;
        height: 60px;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        border-radius: var(--radius-lg);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--white);
        font-size: 1.5rem;
        box-shadow: var(--shadow-md);
      }

      .card-value {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--charcoal);
        line-height: 1;
        margin-bottom: var(--spacing-xs);
      }

      .card-label {
        color: var(--gray);
        font-weight: 500;
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .card-trend {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        margin-top: var(--spacing-sm);
        font-size: 0.875rem;
        font-weight: 500;
      }

      .trend-up {
        color: var(--success);
      }

      .trend-down {
        color: var(--error);
      }

      .trend-neutral {
        color: var(--gray);
      }

      /* Main Dashboard Grid */
      .dashboard-grid {
        display: grid;
        grid-template-columns: 1fr 400px;
        gap: var(--spacing-xl);
        margin-bottom: var(--spacing-xl);
      }

      /* Financial Health Gauge */
      .financial-gauge-container {
        background: var(--white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-xl);
        box-shadow: var(--shadow-md);
        border: 1px solid rgba(45, 125, 50, 0.1);
        margin-bottom: var(--spacing-xl);
      }

      .gauge-header {
        text-align: center;
        margin-bottom: var(--spacing-lg);
      }

      .gauge-title {
        font-family: var(--font-display);
        font-size: 1.75rem;
        font-weight: 600;
        color: var(--charcoal);
        margin-bottom: var(--spacing-sm);
      }

      .gauge-subtitle {
        color: var(--gray);
        font-size: 1rem;
      }

      #financial-gauge {
        height: 300px;
        margin-bottom: var(--spacing-lg);
      }

      .gauge-metrics {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: var(--spacing-md);
        text-align: center;
      }

      .gauge-metric {
        padding: var(--spacing-md);
        background: var(--light-gray);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(45, 125, 50, 0.1);
      }

      .metric-label {
        font-size: 0.875rem;
        color: var(--gray);
        font-weight: 500;
        margin-bottom: var(--spacing-xs);
      }

      .metric-value {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--charcoal);
      }

      /* Cards */
      .card {
        background: var(--white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-xl);
        box-shadow: var(--shadow-md);
        border: 1px solid rgba(45, 125, 50, 0.1);
        transition: var(--transition-normal);
      }

      .card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
      }

      .card-title {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        font-family: var(--font-display);
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--charcoal);
        margin-bottom: var(--spacing-lg);
      }

      .card-title i {
        color: var(--primary-color);
      }

      /* Soil Parameters Grid */
      .parameters-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: var(--spacing-md);
      }

      .parameter-card {
        background: linear-gradient(
          135deg,
          var(--light-gray) 0%,
          var(--white) 100%
        );
        border-radius: var(--radius-lg);
        padding: var(--spacing-md);
        text-align: center;
        border: 2px solid transparent;
        transition: var(--transition-normal);
        position: relative;
        overflow: hidden;
      }

      .parameter-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: var(--gray);
      }

      .parameter-card.optimal::before {
        background: linear-gradient(90deg, var(--success), #4caf50);
      }

      .parameter-card.warning::before {
        background: linear-gradient(90deg, var(--warning), #ff9800);
      }

      .parameter-card.critical::before {
        background: linear-gradient(90deg, var(--error), #f44336);
      }

      .parameter-card:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-md);
        border-color: var(--primary-light);
      }

      .parameter-icon {
        font-size: 2rem;
        margin-bottom: var(--spacing-sm);
        color: var(--primary-color);
      }

      .parameter-card h3 {
        font-size: 0.875rem;
        margin-bottom: var(--spacing-sm);
        color: var(--gray);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .parameter-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--charcoal);
        line-height: 1;
      }

      .parameter-unit {
        font-size: 0.875rem;
        color: var(--gray);
        margin-left: var(--spacing-xs);
      }

      .parameter-status {
        margin-top: var(--spacing-sm);
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: var(--radius-sm);
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
      }

      .parameter-status.optimal {
        background: rgba(76, 175, 80, 0.1);
        color: var(--success);
      }

      .parameter-status.warning {
        background: rgba(255, 152, 0, 0.1);
        color: var(--warning);
      }

      .parameter-status.critical {
        background: rgba(244, 67, 54, 0.1);
        color: var(--error);
      }

      /* Alerts and Recommendations */
      .alerts-section {
        background: var(--white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-xl);
        box-shadow: var(--shadow-md);
        border: 1px solid rgba(45, 125, 50, 0.1);
      }

      .alerts-tabs {
        display: flex;
        border-bottom: 2px solid var(--light-gray);
        margin-bottom: var(--spacing-lg);
      }

      .tab-button {
        padding: var(--spacing-md) var(--spacing-lg);
        border: none;
        background: none;
        cursor: pointer;
        border-bottom: 3px solid transparent;
        transition: var(--transition-fast);
        font-weight: 600;
        color: var(--gray);
        position: relative;
      }

      .tab-button.active {
        border-bottom-color: var(--primary-color);
        color: var(--primary-color);
      }

      .tab-button:hover {
        color: var(--primary-light);
      }

      .alert-item,
      .recommendation-item {
        background: linear-gradient(
          135deg,
          var(--light-gray) 0%,
          var(--white) 100%
        );
        border-radius: var(--radius-lg);
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-md);
        border-left: 4px solid var(--info);
        transition: var(--transition-normal);
      }

      .alert-item:hover,
      .recommendation-item:hover {
        transform: translateX(5px);
        box-shadow: var(--shadow-sm);
      }

      .alert-item.critical {
        border-left-color: var(--error);
        background: linear-gradient(
          135deg,
          rgba(244, 67, 54, 0.05) 0%,
          var(--white) 100%
        );
      }

      .alert-item.warning {
        border-left-color: var(--warning);
        background: linear-gradient(
          135deg,
          rgba(255, 152, 0, 0.05) 0%,
          var(--white) 100%
        );
      }

      .alert-header,
      .recommendation-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-sm);
      }

      .alert-title,
      .recommendation-title {
        font-weight: 600;
        color: var(--charcoal);
      }

      .alert-time {
        font-size: 0.875rem;
        color: var(--gray);
        font-weight: 500;
      }

      .dismiss-alert {
        background: var(--error);
        color: var(--white);
        border: none;
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: var(--radius-sm);
        font-size: 0.75rem;
        cursor: pointer;
        transition: var(--transition-fast);
        margin-top: var(--spacing-sm);
      }

      .dismiss-alert:hover {
        background: #d32f2f;
      }

      /* Crop Recommendations */
      .crop-recommendations {
        background: var(--white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-xl);
        box-shadow: var(--shadow-md);
        border: 1px solid rgba(45, 125, 50, 0.1);
        margin-bottom: var(--spacing-xl);
      }

      .crop-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-sm);
        background: linear-gradient(
          135deg,
          var(--light-gray) 0%,
          var(--white) 100%
        );
        border-radius: var(--radius-lg);
        transition: var(--transition-normal);
      }

      .crop-item:hover {
        transform: translateX(5px);
        box-shadow: var(--shadow-sm);
      }

      .crop-rank {
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        color: var(--white);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
        font-weight: 700;
        box-shadow: var(--shadow-sm);
      }

      .crop-info {
        flex: 1;
      }

      .crop-name {
        font-weight: 600;
        color: var(--charcoal);
        font-size: 1rem;
      }

      .crop-name.best-match {
        color: var(--success);
      }

      .crop-name.good-match {
        color: var(--warning);
      }

      .crop-details {
        font-size: 0.875rem;
        color: var(--gray);
        margin-top: var(--spacing-xs);
      }

      .crop-suitability {
        font-size: 0.875rem;
        font-weight: 600;
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: var(--radius-sm);
        background: var(--light-gray);
        color: var(--gray);
      }

      /* Loan Assessment */
      .loan-assessment {
        background: var(--white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-xl);
        box-shadow: var(--shadow-md);
        border: 1px solid rgba(45, 125, 50, 0.1);
        margin-bottom: var(--spacing-xl);
      }

      .loan-status-indicator {
        padding: var(--spacing-lg);
        border-radius: var(--radius-lg);
        text-align: center;
        margin-bottom: var(--spacing-lg);
        position: relative;
        overflow: hidden;
      }

      .loan-status-indicator::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.2),
          rgba(255, 255, 255, 0.1)
        );
        z-index: 1;
      }

      .loan-status-indicator.eligible {
        background: linear-gradient(135deg, var(--success), #4caf50);
        color: var(--white);
      }

      .loan-status-indicator.conditional {
        background: linear-gradient(135deg, var(--warning), #ff9800);
        color: var(--white);
      }

      .loan-status-indicator.ineligible {
        background: linear-gradient(135deg, var(--error), #f44336);
        color: var(--white);
      }

      .status-text {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: var(--spacing-sm);
        position: relative;
        z-index: 2;
      }

      .status-score {
        font-size: 3rem;
        font-weight: 700;
        position: relative;
        z-index: 2;
      }

      .loan-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-lg);
      }

      .loan-detail {
        text-align: center;
        padding: var(--spacing-md);
        background: linear-gradient(
          135deg,
          var(--light-gray) 0%,
          var(--white) 100%
        );
        border-radius: var(--radius-lg);
        border: 1px solid rgba(45, 125, 50, 0.1);
      }

      .loan-detail-label {
        display: block;
        margin-bottom: var(--spacing-xs);
        color: var(--gray);
        font-size: 0.875rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .loan-detail-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--charcoal);
      }

      /* Buttons */
      .btn {
        padding: var(--spacing-sm) var(--spacing-lg);
        border: none;
        border-radius: var(--radius-md);
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition-fast);
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-sm);
        text-decoration: none;
        font-family: var(--font-primary);
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        color: var(--white);
        box-shadow: var(--shadow-sm);
      }

      .btn-primary:hover {
        background: linear-gradient(
          135deg,
          var(--primary-dark),
          var(--primary-color)
        );
        box-shadow: var(--shadow-md);
        transform: translateY(-1px);
      }

      .btn-secondary {
        background: var(--gray);
        color: var(--white);
      }

      .btn-secondary:hover {
        background: var(--dark-gray);
      }

      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .btn-group {
        display: flex;
        gap: var(--spacing-md);
        justify-content: center;
      }

      /* Charts */
      .chart-container {
        background: var(--white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-xl);
        box-shadow: var(--shadow-md);
        border: 1px solid rgba(45, 125, 50, 0.1);
        margin-bottom: var(--spacing-xl);
      }

      .chart-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-lg);
        flex-wrap: wrap;
        gap: var(--spacing-md);
      }

      .time-window {
        display: flex;
        gap: var(--spacing-xs);
        background: var(--light-gray);
        border-radius: var(--radius-md);
        padding: var(--spacing-xs);
      }

      .time-window button {
        padding: var(--spacing-xs) var(--spacing-md);
        border: none;
        background: none;
        cursor: pointer;
        border-radius: var(--radius-sm);
        transition: var(--transition-fast);
        font-weight: 500;
        color: var(--gray);
      }

      .time-window button.active {
        background: var(--primary-color);
        color: var(--white);
      }

      .time-window button:hover {
        background: var(--primary-light);
        color: var(--white);
      }

      .parameter-select {
        padding: var(--spacing-sm) var(--spacing-md);
        border: 2px solid rgba(45, 125, 50, 0.2);
        border-radius: var(--radius-md);
        background: var(--white);
        color: var(--charcoal);
        font-family: var(--font-primary);
        font-weight: 500;
        transition: var(--transition-fast);
      }

      .parameter-select:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(45, 125, 50, 0.1);
      }

      /* Loading Overlay */
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        transition: var(--transition-normal);
      }

      .loading-overlay.hidden {
        opacity: 0;
        pointer-events: none;
      }

      .spinner {
        width: 60px;
        height: 60px;
        border: 4px solid var(--light-gray);
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        margin-top: var(--spacing-md);
        color: var(--charcoal);
        font-weight: 500;
      }

      /* Empty States */
      .empty-state {
        text-align: center;
        color: var(--gray);
        font-style: italic;
        padding: var(--spacing-xl);
        background: var(--light-gray);
        border-radius: var(--radius-lg);
        border: 2px dashed var(--gray);
      }

      .empty-state i {
        font-size: 3rem;
        margin-bottom: var(--spacing-md);
        color: var(--gray);
      }

      /* Utility Classes */
      .hidden {
        display: none;
      }

      .text-center {
        text-align: center;
      }

      .mb-lg {
        margin-bottom: var(--spacing-lg);
      }

      .mt-lg {
        margin-top: var(--spacing-lg);
      }

      /* View Toggles */
      .view-toggles {
        display: flex;
        gap: var(--spacing-xs);
        background: var(--light-gray);
        border-radius: var(--radius-md);
        padding: var(--spacing-xs);
      }

      .toggle-view {
        padding: var(--spacing-xs) var(--spacing-sm);
        border: none;
        background: none;
        cursor: pointer;
        border-radius: var(--radius-sm);
        transition: var(--transition-fast);
        color: var(--gray);
      }

      .toggle-view.active {
        background: var(--primary-color);
        color: var(--white);
      }

      .toggle-view:hover {
        color: var(--primary-color);
      }

      /* Responsive Design */
      @media (max-width: 1200px) {
        .dashboard-grid {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        body {
          padding-left: 0;
        }

        body.mobile {
          padding-left: 0;
        }

        .sidebar {
          transform: translateX(-100%);
        }

        .sidebar.mobile-open {
          transform: translateX(0);
        }

        .mobile-menu-toggle {
          display: block;
        }

        .breadcrumb {
          display: none;
        }

        .container {
          padding: var(--spacing-md);
        }

        .overview-cards {
          grid-template-columns: 1fr;
        }

        .parameters-grid {
          grid-template-columns: 1fr;
        }

        .loan-details {
          grid-template-columns: 1fr;
        }

        .header-content {
          padding: var(--spacing-md);
        }

        .header-actions {
          flex-direction: column;
          width: 100%;
          gap: var(--spacing-sm);
        }

        .farmer-selector {
          width: 100%;
        }

        .chart-controls {
          flex-direction: column;
          align-items: flex-start;
        }

        .btn-group {
          flex-direction: column;
          width: 100%;
        }

        .btn {
          justify-content: center;
        }
      }

      @media (max-width: 480px) {
        .gauge-metrics {
          grid-template-columns: 1fr;
        }

        .time-window {
          width: 100%;
          justify-content: space-between;
        }

        .sidebar {
          width: 100%;
        }

        .quick-actions {
          flex-direction: column;
          gap: var(--spacing-xs);
        }

        .quick-action {
          width: 100%;
        }
      }

      /* Dashboard Animations */
      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .slide-in-up {
        animation: slideInUp 0.6s ease-out forwards;
      }

      .fade-in {
        animation: fadeIn 0.5s ease-out forwards;
      }

      /* Stagger animations for cards */
      .overview-card:nth-child(1) {
        animation-delay: 0.1s;
      }
      .overview-card:nth-child(2) {
        animation-delay: 0.2s;
      }
      .overview-card:nth-child(3) {
        animation-delay: 0.3s;
      }
      .overview-card:nth-child(4) {
        animation-delay: 0.4s;
      }

      .parameter-card:nth-child(1) {
        animation-delay: 0.1s;
      }
      .parameter-card:nth-child(2) {
        animation-delay: 0.2s;
      }
      .parameter-card:nth-child(3) {
        animation-delay: 0.3s;
      }
      .parameter-card:nth-child(4) {
        animation-delay: 0.4s;
      }
      .parameter-card:nth-child(5) {
        animation-delay: 0.5s;
      }
      .parameter-card:nth-child(6) {
        animation-delay: 0.6s;
      }
    </style>
  </head>

  <body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
      <div class="spinner"></div>
      <div class="loading-text">Loading Dashboard...</div>
    </div>

    <!-- Sidebar Navigation -->
    <nav id="sidebar" class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="logo-icon">
            <i class="fas fa-seedling"></i>
          </div>
          <span class="logo-text">Talazo AgriFinance</span>
        </div>
        <button id="sidebar-toggle" class="sidebar-toggle">
          <i class="fas fa-bars"></i>
        </button>
      </div>

      <div class="sidebar-content">
        <div class="user-profile">
          <div class="profile-avatar">
            <i class="fas fa-user-circle"></i>
          </div>
          <div class="profile-info">
            <div class="profile-name">Financial Officer</div>
            <div class="profile-role">AgriFinance Division</div>
          </div>
        </div>

        <ul class="nav-menu">
          <li class="nav-item active">
            <a href="/dashboard" class="nav-link">
              <i class="fas fa-tachometer-alt"></i>
              <span class="nav-text">Dashboard</span>
              <div class="nav-indicator"></div>
            </a>
          </li>
          <li class="nav-item">
            <a href="/farmers" class="nav-link">
              <i class="fas fa-users"></i>
              <span class="nav-text">Farmers</span>
              <div class="nav-badge">156</div>
            </a>
          </li>
          <li class="nav-item">
            <a href="/loans" class="nav-link">
              <i class="fas fa-hand-holding-usd"></i>
              <span class="nav-text">Loans</span>
              <div class="nav-badge">23</div>
            </a>
          </li>
          <li class="nav-item">
            <a href="/insurance" class="nav-link">
              <i class="fas fa-shield-alt"></i>
              <span class="nav-text">Insurance</span>
              <div class="nav-badge">89</div>
            </a>
          </li>
          <li class="nav-item">
            <a href="/soil_analysis" class="nav-link">
              <i class="fas fa-vial"></i>
              <span class="nav-text">Soil Analysis</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="/ai_recommendations" class="nav-link">
              <i class="fas fa-brain"></i>
              <span class="nav-text">AI Recommendations</span>
              <div class="nav-notification"></div>
            </a>
          </li>

          <li class="nav-divider"></li>

          <li class="nav-section">
            <span class="nav-section-title">Analytics</span>
          </li>
          <li class="nav-item">
            <a href="/reports" class="nav-link">
              <i class="fas fa-chart-bar"></i>
              <span class="nav-text">Reports</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="/trends" class="nav-link">
              <i class="fas fa-chart-line"></i>
              <span class="nav-text">Market Trends</span>
            </a>
          </li>

          <li class="nav-divider"></li>

          <li class="nav-section">
            <span class="nav-section-title">System</span>
          </li>
          <li class="nav-item">
            <a href="/settings" class="nav-link">
              <i class="fas fa-cog"></i>
              <span class="nav-text">Settings</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="/help" class="nav-link">
              <i class="fas fa-question-circle"></i>
              <span class="nav-text">Help & Support</span>
            </a>
          </li>
        </ul>

        <div class="sidebar-footer">
          <div class="quick-actions">
            <button class="quick-action" title="Add New Farmer">
              <i class="fas fa-user-plus"></i>
            </button>
            <button class="quick-action" title="Quick Loan Assessment">
              <i class="fas fa-calculator"></i>
            </button>
            <button class="quick-action" title="Emergency Alert">
              <i class="fas fa-bell"></i>
            </button>
          </div>
          <button class="logout-btn">
            <i class="fas fa-sign-out-alt"></i>
            <span class="nav-text">Logout</span>
          </button>
        </div>
      </div>
    </nav>

    <!-- Mobile Overlay -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>

    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="header-left">
          <button id="mobile-menu-toggle" class="mobile-menu-toggle">
            <i class="fas fa-bars"></i>
          </button>
          <div class="breadcrumb">
            <i class="fas fa-tachometer-alt"></i>
            <span>Dashboard</span>
            <i class="fas fa-chevron-right"></i>
            <span>Overview</span>
          </div>
        </div>
        <div class="header-actions">
          <select id="farmer-selector" class="farmer-selector">
            <option value="demo">Demo Farmer - Mashonaland East</option>
            <option value="1">John Moyo - Harare Province</option>
            <option value="2">Mary Ncube - Bulawayo Province</option>
            <option value="3">Peter Chikwanha - Manicaland</option>
          </select>
          <button id="refresh-data" class="btn btn-secondary">
            <i class="fas fa-sync"></i> Refresh Data
          </button>
          <div class="status-indicator online">
            <div class="status-pulse"></div>
            <span>Live Data</span>
          </div>
        </div>
      </div>
    </header>

    <div class="container">
      <!-- Overview Cards -->
      <div class="overview-cards">
        <div class="overview-card slide-in-up">
          <div class="card-header">
            <div>
              <div class="card-value" id="financial-index-value">78.5</div>
              <div class="card-label">Financial Health Index</div>
              <div class="card-trend trend-up">
                <i class="fas fa-arrow-up"></i>
                <span>+5.2% from last month</span>
              </div>
            </div>
            <div class="card-icon">
              <i class="fas fa-chart-line"></i>
            </div>
          </div>
        </div>

        <div class="overview-card slide-in-up">
          <div class="card-header">
            <div>
              <div class="card-value" id="risk-score-value">Low</div>
              <div class="card-label">Risk Assessment</div>
              <div class="card-trend trend-up">
                <i class="fas fa-shield-check"></i>
                <span>Excellent rating</span>
              </div>
            </div>
            <div class="card-icon">
              <i class="fas fa-shield-alt"></i>
            </div>
          </div>
        </div>

        <div class="overview-card slide-in-up">
          <div class="card-header">
            <div>
              <div class="card-value">
                $<span id="loan-eligible-amount">25,000</span>
              </div>
              <div class="card-label">Loan Eligibility</div>
              <div class="card-trend trend-up">
                <i class="fas fa-arrow-up"></i>
                <span>+$5,000 increase</span>
              </div>
            </div>
            <div class="card-icon">
              <i class="fas fa-dollar-sign"></i>
            </div>
          </div>
        </div>

        <div class="overview-card slide-in-up">
          <div class="card-header">
            <div>
              <div class="card-value">
                <span id="yield-prediction-value">4.2</span>t/ha
              </div>
              <div class="card-label">Predicted Yield</div>
              <div class="card-trend trend-up">
                <i class="fas fa-arrow-up"></i>
                <span>Above average</span>
              </div>
            </div>
            <div class="card-icon">
              <i class="fas fa-seedling"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Financial Health Gauge -->
      <div class="financial-gauge-container fade-in">
        <div class="gauge-header">
          <h2 class="gauge-title">
            <i class="fas fa-tachometer-alt"></i>
            Financial Health Assessment
          </h2>
          <p class="gauge-subtitle">
            Comprehensive analysis based on soil health, farm characteristics,
            and market conditions
          </p>
        </div>
        <div id="financial-gauge"></div>
        <div class="gauge-metrics">
          <div class="gauge-metric">
            <div class="metric-label">Risk Level</div>
            <div class="metric-value" id="risk-level-indicator">Low Risk</div>
          </div>
          <div class="gauge-metric">
            <div class="metric-label">Premium Estimate</div>
            <div class="metric-value">$<span id="premium-value">145</span></div>
          </div>
          <div class="gauge-metric">
            <div class="metric-label">Confidence Score</div>
            <div class="metric-value">
              <span id="confidence-score">94</span>%
            </div>
          </div>
        </div>
      </div>

      <!-- Dashboard Grid -->
      <div class="dashboard-grid">
        <!-- Soil Parameters -->
        <div class="card fade-in">
          <div class="card-header">
            <div class="card-title">
              <i class="fas fa-vial"></i>
              <span>Soil Health Parameters</span>
            </div>
            <div class="view-toggles">
              <button
                class="toggle-view active"
                data-view="grid"
                title="Grid View"
              >
                <i class="fas fa-th"></i>
              </button>
              <button class="toggle-view" data-view="list" title="List View">
                <i class="fas fa-list"></i>
              </button>
            </div>
          </div>
          <div id="parameters-grid" class="parameters-grid">
            <!-- Parameters will be populated by JavaScript -->
            <div class="parameter-card optimal slide-in-up">
              <div class="parameter-icon">
                <i class="fas fa-flask"></i>
              </div>
              <h3>pH Level</h3>
              <div class="parameter-value">
                6.8<span class="parameter-unit">pH</span>
              </div>
              <div class="parameter-status optimal">Optimal</div>
            </div>

            <div class="parameter-card optimal slide-in-up">
              <div class="parameter-icon">
                <i class="fas fa-leaf"></i>
              </div>
              <h3>Nitrogen</h3>
              <div class="parameter-value">
                45<span class="parameter-unit">mg/kg</span>
              </div>
              <div class="parameter-status optimal">Good</div>
            </div>

            <div class="parameter-card warning slide-in-up">
              <div class="parameter-icon">
                <i class="fas fa-seedling"></i>
              </div>
              <h3>Phosphorus</h3>
              <div class="parameter-value">
                18<span class="parameter-unit">mg/kg</span>
              </div>
              <div class="parameter-status warning">Moderate</div>
            </div>

            <div class="parameter-card optimal slide-in-up">
              <div class="parameter-icon">
                <i class="fas fa-atom"></i>
              </div>
              <h3>Potassium</h3>
              <div class="parameter-value">
                165<span class="parameter-unit">mg/kg</span>
              </div>
              <div class="parameter-status optimal">Excellent</div>
            </div>

            <div class="parameter-card optimal slide-in-up">
              <div class="parameter-icon">
                <i class="fas fa-recycle"></i>
              </div>
              <h3>Organic Matter</h3>
              <div class="parameter-value">
                3.2<span class="parameter-unit">%</span>
              </div>
              <div class="parameter-status optimal">Good</div>
            </div>

            <div class="parameter-card warning slide-in-up">
              <div class="parameter-icon">
                <i class="fas fa-tint"></i>
              </div>
              <h3>Moisture</h3>
              <div class="parameter-value">
                22<span class="parameter-unit">%</span>
              </div>
              <div class="parameter-status warning">Low</div>
            </div>
          </div>
        </div>

        <!-- Alerts and Recommendations -->
        <div class="alerts-section fade-in">
          <div class="card-title">
            <i class="fas fa-bell"></i>
            <span>Alerts & Recommendations</span>
          </div>
          <div class="alerts-tabs">
            <button class="tab-button active" data-tab="alerts">
              <i class="fas fa-exclamation-triangle"></i>
              Alerts
            </button>
            <button class="tab-button" data-tab="recommendations">
              <i class="fas fa-lightbulb"></i>
              Recommendations
            </button>
          </div>
          <div id="alerts-container">
            <div class="alert-item warning">
              <div class="alert-header">
                <div class="alert-title">Low Moisture Detected</div>
                <div class="alert-time">2 hours ago</div>
              </div>
              <p>
                Soil moisture levels are below optimal range. Consider
                irrigation scheduling.
              </p>
              <button class="dismiss-alert">Dismiss</button>
            </div>
            <div class="alert-item critical">
              <div class="alert-header">
                <div class="alert-title">Phosphorus Deficiency</div>
                <div class="alert-time">1 day ago</div>
              </div>
              <p>
                Phosphorus levels are moderate. Apply fertilizer to improve crop
                yield potential.
              </p>
              <button class="dismiss-alert">Dismiss</button>
            </div>
          </div>
          <div id="recommendations-container" class="hidden">
            <div class="recommendation-item">
              <div class="recommendation-header">
                <div class="recommendation-title">Fertilizer Application</div>
              </div>
              <p>
                Apply phosphorus-rich fertilizer (10-20-10) at 150kg/ha to
                optimize soil nutrients.
              </p>
            </div>
            <div class="recommendation-item">
              <div class="recommendation-header">
                <div class="recommendation-title">Irrigation Schedule</div>
              </div>
              <p>
                Implement drip irrigation system to maintain soil moisture
                between 25-30%.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Crop Recommendations -->
      <div class="crop-recommendations fade-in">
        <div class="card-title">
          <i class="fas fa-leaf"></i>
          <span>Optimal Crop Recommendations</span>
        </div>
        <div id="suitable-crops-list">
          <div class="crop-item">
            <div class="crop-rank">1</div>
            <div class="crop-info">
              <div class="crop-name best-match">Maize (Hybrid Varieties)</div>
              <div class="crop-details">
                Expected yield: 4.5-5.2 t/ha • Growing season: Oct-Mar
              </div>
            </div>
            <div class="crop-suitability">95% Match</div>
          </div>
          <div class="crop-item">
            <div class="crop-rank">2</div>
            <div class="crop-info">
              <div class="crop-name good-match">Soybeans</div>
              <div class="crop-details">
                Expected yield: 2.8-3.2 t/ha • Growing season: Nov-Apr
              </div>
            </div>
            <div class="crop-suitability">88% Match</div>
          </div>
          <div class="crop-item">
            <div class="crop-rank">3</div>
            <div class="crop-info">
              <div class="crop-name good-match">Tobacco (Burley)</div>
              <div class="crop-details">
                Expected yield: 2.2-2.6 t/ha • Growing season: Sep-Feb
              </div>
            </div>
            <div class="crop-suitability">82% Match</div>
          </div>
        </div>
      </div>

      <!-- Loan Assessment -->
      <div class="loan-assessment fade-in">
        <div class="card-title">
          <i class="fas fa-university"></i>
          <span>Credit Assessment & Loan Eligibility</span>
        </div>

        <div id="loan-status-indicator" class="loan-status-indicator eligible">
          <div class="status-text">LOAN APPROVED</div>
          <div class="status-score">78.5/100</div>
        </div>

        <div class="loan-details">
          <div class="loan-detail">
            <span class="loan-detail-label">Maximum Loan Amount</span>
            <div class="loan-detail-value">
              $<span id="max-loan-amount">25,000</span>
            </div>
          </div>
          <div class="loan-detail">
            <span class="loan-detail-label">Interest Rate</span>
            <div class="loan-detail-value">
              <span id="interest-rate">8.5</span>%
            </div>
          </div>
          <div class="loan-detail">
            <span class="loan-detail-label">Loan Term</span>
            <div class="loan-detail-value">
              <span id="loan-term">24</span> months
            </div>
          </div>
          <div class="loan-detail">
            <span class="loan-detail-label">Monthly Payment</span>
            <div class="loan-detail-value">
              $<span id="monthly-payment">1,245</span>
            </div>
          </div>
        </div>

        <div class="btn-group">
          <button id="process-loan-btn" class="btn btn-primary">
            <i class="fas fa-file-contract"></i> Process Loan Application
          </button>
          <button id="view-history-btn" class="btn btn-secondary">
            <i class="fas fa-history"></i> View Credit History
          </button>
          <button id="download-report-btn" class="btn btn-secondary">
            <i class="fas fa-download"></i> Download Assessment
          </button>
        </div>
      </div>

      <!-- Charts Section -->
      <div class="chart-container fade-in">
        <div class="card-title">
          <i class="fas fa-chart-area"></i>
          <span>Soil Parameter Trends</span>
        </div>
        <div class="chart-controls">
          <div>
            <select id="parameter-select" class="parameter-select">
              <option value="ph_level">pH Level</option>
              <option value="nitrogen_level">Nitrogen Content</option>
              <option value="phosphorus_level">Phosphorus Content</option>
              <option value="potassium_level">Potassium Content</option>
              <option value="organic_matter">Organic Matter</option>
              <option value="moisture_content">Soil Moisture</option>
            </select>
          </div>
          <div class="time-window">
            <button class="active" data-minutes="60">1 Hour</button>
            <button data-minutes="360">6 Hours</button>
            <button data-minutes="1440">24 Hours</button>
            <button data-minutes="10080">7 Days</button>
          </div>
        </div>
        <div id="trend-chart" style="height: 350px"></div>
      </div>

      <!-- Yield Prediction Chart -->
      <div class="chart-container fade-in">
        <div class="card-title">
          <i class="fas fa-chart-bar"></i>
          <span>Crop Yield Predictions by Season</span>
        </div>
        <div id="yield-chart" style="height: 350px"></div>
      </div>
    </div>

    <!-- Enhanced JavaScript with Sophisticated Interactions -->
    <script>
      // Dashboard Configuration and State Management
      const DashboardConfig = {
        refreshInterval: 30000, // 30 seconds
        animationDelay: 100,
        apiEndpoints: {
          soilData: "/api/soil-analysis",
          farmData: "/api/farm-assessment",
          trends: "/api/trends",
        },
      };

      let dashboardState = {
        currentFarmer: "demo",
        activeTab: "alerts",
        isLoading: false,
        lastUpdate: null,
      };

      // Initialize Dashboard
      document.addEventListener("DOMContentLoaded", function () {
        initializeDashboard();
        initializeSidebar();
        setupEventListeners();
        loadInitialData();
        startAutoRefresh();
        initializeAnimations();
      });

      function initializeDashboard() {
        console.log("🌱 Talazo AgriFinance Dashboard Initialized");
        updateLastUpdateTime();
        createFinancialGauge();
        createTrendChart();
        createYieldChart();
      }

      function setupEventListeners() {
        // Sidebar toggles
        document
          .getElementById("sidebar-toggle")
          .addEventListener("click", function () {
            toggleSidebar();
          });

        document
          .getElementById("mobile-menu-toggle")
          .addEventListener("click", function () {
            toggleMobileSidebar();
          });

        document
          .getElementById("sidebar-overlay")
          .addEventListener("click", function () {
            closeMobileSidebar();
          });

        // Navigation links
        document.querySelectorAll(".nav-link").forEach((link) => {
          link.addEventListener("click", function (e) {
            // Remove active class from all nav items
            document.querySelectorAll(".nav-item").forEach((item) => {
              item.classList.remove("active");
            });

            // Add active class to clicked item
            this.closest(".nav-item").classList.add("active");

            // Close mobile sidebar if open
            if (window.innerWidth <= 768) {
              closeMobileSidebar();
            }
          });
        });

        // Quick actions
        document.querySelectorAll(".quick-action").forEach((button) => {
          button.addEventListener("click", function () {
            const title = this.getAttribute("title");
            showToast(`${title} feature coming soon!`, "info");
          });
        });

        // Logout button
        document
          .querySelector(".logout-btn")
          .addEventListener("click", function () {
            if (confirm("Are you sure you want to logout?")) {
              showToast("Logging out...", "info");
              setTimeout(() => {
                window.location.href = "/";
              }, 1500);
            }
          });

        // Farmer selector
        document
          .getElementById("farmer-selector")
          .addEventListener("change", function (e) {
            dashboardState.currentFarmer = e.target.value;
            updateBreadcrumb();
            refreshDashboard();
          });

        // Refresh button
        document
          .getElementById("refresh-data")
          .addEventListener("click", function () {
            refreshDashboard();
          });

        // Tab switching
        document.querySelectorAll(".tab-button").forEach((button) => {
          button.addEventListener("click", function () {
            switchTab(this.dataset.tab);
          });
        });

        // View toggles
        document.querySelectorAll(".toggle-view").forEach((button) => {
          button.addEventListener("click", function () {
            toggleParametersView(this.dataset.view);
          });
        });

        // Time window buttons
        document.querySelectorAll(".time-window button").forEach((button) => {
          button.addEventListener("click", function () {
            setActiveTimeWindow(this);
            updateTrendChart(this.dataset.minutes);
          });
        });

        // Parameter selector
        document
          .getElementById("parameter-select")
          .addEventListener("change", function () {
            updateTrendChart();
          });

        // Loan buttons
        document
          .getElementById("process-loan-btn")
          .addEventListener("click", processLoanApplication);
        document
          .getElementById("view-history-btn")
          .addEventListener("click", viewCreditHistory);
        document
          .getElementById("download-report-btn")
          .addEventListener("click", downloadAssessment);

        // Dismiss alerts
        document.addEventListener("click", function (e) {
          if (e.target.classList.contains("dismiss-alert")) {
            dismissAlert(e.target);
          }
        });

        // Handle window resize
        window.addEventListener("resize", handleResize);
      }

      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        const body = document.body;

        sidebar.classList.toggle("collapsed");
        body.classList.toggle("sidebar-collapsed");

        // Store preference
        localStorage.setItem(
          "sidebarCollapsed",
          sidebar.classList.contains("collapsed")
        );
      }

      function toggleMobileSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebar-overlay");

        sidebar.classList.toggle("mobile-open");
        overlay.classList.toggle("active");
        document.body.style.overflow = sidebar.classList.contains("mobile-open")
          ? "hidden"
          : "";
      }

      function closeMobileSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebar-overlay");

        sidebar.classList.remove("mobile-open");
        overlay.classList.remove("active");
        document.body.style.overflow = "";
      }

      function handleResize() {
        const sidebar = document.getElementById("sidebar");
        const body = document.body;

        if (window.innerWidth <= 768) {
          body.classList.add("mobile");
          closeMobileSidebar();
        } else {
          body.classList.remove("mobile");
          sidebar.classList.remove("mobile-open");
          document.getElementById("sidebar-overlay").classList.remove("active");
          document.body.style.overflow = "";
        }

        // Resize charts
        setTimeout(() => {
          if (typeof Plotly !== "undefined") {
            Plotly.Plots.resize("financial-gauge");
            Plotly.Plots.resize("trend-chart");
            Plotly.Plots.resize("yield-chart");
          }
        }, 100);
      }

      function updateBreadcrumb() {
        const selector = document.getElementById("farmer-selector");
        const breadcrumb = document.querySelector(".breadcrumb");
        const selectedFarmer = selector.options[selector.selectedIndex].text;

        if (breadcrumb && selectedFarmer !== "Demo Farmer - Mashonaland East") {
          const farmerName = selectedFarmer.split(" - ")[0];
          breadcrumb.innerHTML = `
            <i class="fas fa-tachometer-alt"></i>
            <span>Dashboard</span>
            <i class="fas fa-chevron-right"></i>
            <span>${farmerName}</span>
          `;
        }
      }

      function initializeSidebar() {
        // Restore sidebar state
        const isCollapsed = localStorage.getItem("sidebarCollapsed") === "true";
        if (isCollapsed) {
          document.getElementById("sidebar").classList.add("collapsed");
          document.body.classList.add("sidebar-collapsed");
        }

        // Handle initial mobile state
        handleResize();
      }

      function initializeAnimations() {
        // Add staggered animations to cards
        const cards = document.querySelectorAll(".slide-in-up, .fade-in");
        cards.forEach((card, index) => {
          setTimeout(() => {
            card.style.opacity = "0";
            card.style.transform = "translateY(20px)";
            card.style.transition = "all 0.6s ease-out";

            setTimeout(() => {
              card.style.opacity = "1";
              card.style.transform = "translateY(0)";
            }, 50);
          }, index * DashboardConfig.animationDelay);
        });

        // Animate counter values
        animateCounters();
      }

      function animateCounters() {
        const counters = [
          { element: "financial-index-value", target: 78.5, suffix: "" },
          {
            element: "loan-eligible-amount",
            target: 25000,
            prefix: "",
            suffix: "",
          },
          { element: "yield-prediction-value", target: 4.2, suffix: "" },
        ];

        counters.forEach((counter) => {
          const element = document.getElementById(counter.element);
          if (element) {
            animateValue(
              element,
              0,
              counter.target,
              2000,
              counter.prefix,
              counter.suffix
            );
          }
        });
      }

      function animateValue(
        element,
        start,
        end,
        duration,
        prefix = "",
        suffix = ""
      ) {
        const startTime = performance.now();
        const startValue = start;
        const endValue = end;

        function updateValue(currentTime) {
          const elapsed = currentTime - startTime;
          const progress = Math.min(elapsed / duration, 1);

          // Easing function for smooth animation
          const easeOutCubic = 1 - Math.pow(1 - progress, 3);
          const currentValue =
            startValue + (endValue - startValue) * easeOutCubic;

          if (Number.isInteger(endValue)) {
            element.textContent =
              prefix + Math.round(currentValue).toLocaleString() + suffix;
          } else {
            element.textContent = prefix + currentValue.toFixed(1) + suffix;
          }

          if (progress < 1) {
            requestAnimationFrame(updateValue);
          }
        }

        requestAnimationFrame(updateValue);
      }

      function createFinancialGauge() {
        const gaugeData = [
          {
            type: "indicator",
            mode: "gauge+number+delta",
            value: 78.5,
            domain: { x: [0, 1], y: [0, 1] },
            gauge: {
              axis: { range: [null, 100] },
              bar: { color: "#2d7d32" },
              steps: [
                { range: [0, 25], color: "#ffcdd2" },
                { range: [25, 50], color: "#fff3e0" },
                { range: [50, 75], color: "#e8f5e9" },
                { range: [75, 100], color: "#c8e6c9" },
              ],
              threshold: {
                line: { color: "#1b5e20", width: 4 },
                thickness: 0.75,
                value: 90,
              },
            },
            title: { text: "Financial Health Score" },
            number: { suffix: "/100", font: { size: 24 } },
          },
        ];

        const layout = {
          width: "100%",
          height: 300,
          margin: { t: 20, b: 20, l: 20, r: 20 },
          paper_bgcolor: "rgba(0,0,0,0)",
          plot_bgcolor: "rgba(0,0,0,0)",
          font: {
            family: "Inter, sans-serif",
            size: 14,
            color: "#212121",
          },
        };

        const config = {
          displayModeBar: false,
          responsive: true,
        };

        Plotly.newPlot("financial-gauge", gaugeData, layout, config);
      }

      function createTrendChart() {
        const hours = Array.from({ length: 24 }, (_, i) => {
          const date = new Date();
          date.setHours(date.getHours() - (23 - i));
          return date.toLocaleTimeString("en-US", {
            hour: "2-digit",
            minute: "2-digit",
          });
        });

        const phData = Array.from(
          { length: 24 },
          () => 6.5 + Math.random() * 0.6
        );

        const trace = {
          x: hours,
          y: phData,
          type: "scatter",
          mode: "lines+markers",
          name: "pH Level",
          line: {
            color: "#2d7d32",
            width: 3,
            shape: "spline",
          },
          marker: {
            color: "#4caf50",
            size: 6,
          },
          fill: "tonexty",
          fillcolor: "rgba(45, 125, 50, 0.1)",
        };

        const layout = {
          title: {
            text: "pH Level Trend (24 Hours)",
            font: { family: "Inter, sans-serif", size: 16 },
          },
          xaxis: {
            title: "Time",
            gridcolor: "#e0e0e0",
          },
          yaxis: {
            title: "pH Value",
            gridcolor: "#e0e0e0",
            range: [6.0, 7.5],
          },
          margin: { t: 50, b: 50, l: 60, r: 20 },
          paper_bgcolor: "rgba(0,0,0,0)",
          plot_bgcolor: "rgba(0,0,0,0)",
          font: { family: "Inter, sans-serif" },
        };

        const config = {
          displayModeBar: false,
          responsive: true,
        };

        Plotly.newPlot("trend-chart", [trace], layout, config);
      }

      function createYieldChart() {
        const crops = ["Maize", "Soybeans", "Tobacco", "Cotton", "Wheat"];
        const currentYield = [4.2, 2.8, 2.2, 1.8, 3.1];
        const potentialYield = [5.2, 3.2, 2.6, 2.3, 3.6];

        const trace1 = {
          x: crops,
          y: currentYield,
          type: "bar",
          name: "Current Prediction",
          marker: { color: "#4caf50" },
        };

        const trace2 = {
          x: crops,
          y: potentialYield,
          type: "bar",
          name: "Optimal Potential",
          marker: { color: "#2d7d32" },
        };

        const layout = {
          title: {
            text: "Crop Yield Comparison (tonnes/hectare)",
            font: { family: "Inter, sans-serif", size: 16 },
          },
          xaxis: { title: "Crops" },
          yaxis: { title: "Yield (t/ha)" },
          barmode: "group",
          margin: { t: 50, b: 50, l: 60, r: 20 },
          paper_bgcolor: "rgba(0,0,0,0)",
          plot_bgcolor: "rgba(0,0,0,0)",
          font: { family: "Inter, sans-serif" },
        };

        const config = {
          displayModeBar: false,
          responsive: true,
        };

        Plotly.newPlot("yield-chart", [trace1, trace2], layout, config);
      }

      function refreshDashboard() {
        if (dashboardState.isLoading) return;

        dashboardState.isLoading = true;
        showLoadingOverlay();

        // Simulate API call
        setTimeout(() => {
          updateDashboardData();
          hideLoadingOverlay();
          dashboardState.isLoading = false;
          updateLastUpdateTime();

          showToast("Dashboard updated successfully!", "success");
        }, 1500);
      }

      function updateDashboardData() {
        // Update financial index with animation
        const newIndex = 75 + Math.random() * 20;
        const indexElement = document.getElementById("financial-index-value");
        animateValue(
          indexElement,
          parseFloat(indexElement.textContent),
          newIndex,
          1000
        );

        // Update other metrics
        document.getElementById("premium-value").textContent = Math.floor(
          120 + Math.random() * 50
        );
        document.getElementById("confidence-score").textContent = Math.floor(
          85 + Math.random() * 10
        );

        // Update parameter cards with new values
        updateParameterCards();
      }

      function updateParameterCards() {
        const parameters = document.querySelectorAll(".parameter-card");
        parameters.forEach((card) => {
          const valueElement = card.querySelector(".parameter-value");
          if (valueElement) {
            const currentValue = parseFloat(valueElement.textContent);
            const newValue = currentValue + (Math.random() - 0.5) * 0.2;
            valueElement.innerHTML =
              newValue.toFixed(1) +
              valueElement.querySelector(".parameter-unit").outerHTML;
          }
        });
      }

      function switchTab(tabName) {
        dashboardState.activeTab = tabName;

        // Update tab buttons
        document.querySelectorAll(".tab-button").forEach((btn) => {
          btn.classList.remove("active");
        });
        document
          .querySelector(`[data-tab="${tabName}"]`)
          .classList.add("active");

        // Show/hide content
        document
          .getElementById("alerts-container")
          .classList.toggle("hidden", tabName !== "alerts");
        document
          .getElementById("recommendations-container")
          .classList.toggle("hidden", tabName !== "recommendations");
      }

      function toggleParametersView(view) {
        document.querySelectorAll(".toggle-view").forEach((btn) => {
          btn.classList.remove("active");
        });
        document.querySelector(`[data-view="${view}"]`).classList.add("active");

        const grid = document.getElementById("parameters-grid");
        if (view === "list") {
          grid.style.gridTemplateColumns = "1fr";
        } else {
          grid.style.gridTemplateColumns =
            "repeat(auto-fit, minmax(180px, 1fr))";
        }
      }

      function setActiveTimeWindow(button) {
        document.querySelectorAll(".time-window button").forEach((btn) => {
          btn.classList.remove("active");
        });
        button.classList.add("active");
      }

      function updateTrendChart(minutes = 1440) {
        // Update chart based on selected time window
        // This would typically fetch new data from the API
        console.log(`Updating trend chart for ${minutes} minutes`);
      }

      function processLoanApplication() {
        showToast("Processing loan application...", "info");
        // Simulate processing
        setTimeout(() => {
          showToast("Loan application submitted successfully!", "success");
        }, 2000);
      }

      function viewCreditHistory() {
        showToast("Loading credit history...", "info");
      }

      function downloadAssessment() {
        showToast("Generating assessment report...", "info");
        setTimeout(() => {
          showToast("Report downloaded successfully!", "success");
        }, 1500);
      }

      function dismissAlert(button) {
        const alertItem = button.closest(".alert-item");
        alertItem.style.transform = "translateX(100%)";
        alertItem.style.opacity = "0";
        setTimeout(() => {
          alertItem.remove();
        }, 300);
      }

      function showLoadingOverlay() {
        document.getElementById("loading-overlay").classList.remove("hidden");
      }

      function hideLoadingOverlay() {
        document.getElementById("loading-overlay").classList.add("hidden");
      }

      function updateLastUpdateTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString("en-US", {
          hour12: false,
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit",
        });

        const timeElement = document.getElementById("last-update-time");
        if (timeElement) {
          timeElement.textContent = timeString;
        }

        dashboardState.lastUpdate = now;
      }

      function startAutoRefresh() {
        setInterval(() => {
          if (!dashboardState.isLoading) {
            refreshDashboard();
          }
        }, DashboardConfig.refreshInterval);
      }

      function loadInitialData() {
        // Simulate initial data load
        setTimeout(() => {
          hideLoadingOverlay();
          showToast("Dashboard loaded successfully!", "success");
        }, 1000);
      }

      function showToast(message, type = "info") {
        const toastConfig = {
          text: message,
          duration: 3000,
          gravity: "top",
          position: "right",
          stopOnFocus: true,
          style: {
            background:
              type === "success"
                ? "#4caf50"
                : type === "error"
                ? "#f44336"
                : type === "warning"
                ? "#ff9800"
                : "#2196f3",
            borderRadius: "8px",
            fontFamily: "Inter, sans-serif",
            fontWeight: "500",
          },
        };

        if (typeof Toastify !== "undefined") {
          Toastify(toastConfig).showToast();
        } else {
          console.log(`Toast: ${message} (${type})`);
        }
      }

      // Enhanced error handling
      window.addEventListener("error", function (e) {
        console.error("Dashboard Error:", e.error);
        showToast("An error occurred. Please refresh the page.", "error");
      });

      // Responsive chart handling
      window.addEventListener("resize", function () {
        handleResize();
      });
    </script>
  </body>
</html>
