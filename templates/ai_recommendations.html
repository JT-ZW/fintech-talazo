<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Recommendations - Talazo AgriFinance</title>
    <meta
      name="description"
      content="AI-powered recommendations for optimal farming decisions and financial strategies"
    />

    <!-- External Libraries -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js@1.12.0/src/toastify.min.js"></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/toastify-js@1.12.0/src/toastify.min.css"
    />

    <style>
      /* Talazo AgriFinance - AI Recommendations Professional Styling */

      :root {
        /* Color Palette - Professional Financial Institution */
        --primary-color: #2d7d32; /* Forest Green */
        --primary-light: #4caf50; /* Light Green */
        --primary-dark: #1b5e20; /* Dark Green */
        --secondary-color: #ff8f00; /* Amber */
        --secondary-light: #ffb74d; /* Light Amber */
        --accent-color: #795548; /* Brown */
        --accent-light: #a1887f; /* Light Brown */

        /* Neutral Colors */
        --white: #ffffff;
        --off-white: #fafafa;
        --light-gray: #f5f5f5;
        --gray: #9e9e9e;
        --dark-gray: #424242;
        --charcoal: #212121;

        /* Financial Status Colors */
        --success: #4caf50;
        --warning: #ff9800;
        --error: #f44336;
        --info: #2196f3;
        --excellent: #0d7377;
        --good: #14a085;
        --fair: #f39c12;
        --poor: #e74c3c;

        /* AI Confidence Colors */
        --high-confidence: #4caf50;
        --medium-confidence: #ff9800;
        --low-confidence: #f44336;

        /* Typography */
        --font-primary: "Inter", sans-serif;
        --font-display: "Playfair Display", serif;

        /* Spacing */
        --spacing-xs: 0.5rem;
        --spacing-sm: 1rem;
        --spacing-md: 1.5rem;
        --spacing-lg: 2rem;
        --spacing-xl: 3rem;
        --spacing-xxl: 4rem;

        /* Border Radius */
        --radius-sm: 6px;
        --radius-md: 10px;
        --radius-lg: 16px;
        --radius-xl: 24px;

        /* Shadows */
        --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.12);
        --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.15);
        --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.2);

        /* Transitions */
        --transition-fast: 0.2s ease;
        --transition-normal: 0.3s ease;
        --transition-slow: 0.5s ease;
      }

      /* Reset and Base Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: var(--font-primary);
        background: linear-gradient(
          135deg,
          #f8fffe 0%,
          #e8f5e8 50%,
          #f0f8f0 100%
        );
        color: var(--charcoal);
        line-height: 1.6;
        min-height: 100vh;
        padding-left: 280px; /* Account for sidebar */
        transition: padding-left var(--transition-normal);
        overflow-x: hidden;
      }

      body.sidebar-collapsed {
        padding-left: 80px;
      }

      body.mobile {
        padding-left: 0;
      }

      /* Sidebar Styles - Matching Dashboard */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 280px;
        height: 100vh;
        background: linear-gradient(180deg, var(--charcoal) 0%, #1a1a1a 100%);
        color: var(--white);
        z-index: 1000;
        display: flex;
        flex-direction: column;
        transition: var(--transition-normal);
        box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .sidebar.collapsed {
        width: 80px;
      }

      .sidebar-header {
        padding: var(--spacing-lg);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        justify-content: space-between;
        min-height: 70px;
      }

      .sidebar-logo {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        transition: var(--transition-normal);
      }

      .sidebar-logo .logo-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        border-radius: var(--radius-lg);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--white);
        font-size: 1.25rem;
        box-shadow: var(--shadow-md);
        flex-shrink: 0;
      }

      .logo-text {
        font-family: var(--font-display);
        font-size: 1.25rem;
        font-weight: 600;
        white-space: nowrap;
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .logo-text {
        opacity: 0;
        width: 0;
      }

      .sidebar-toggle {
        background: none;
        border: none;
        color: var(--white);
        font-size: 1.25rem;
        cursor: pointer;
        padding: var(--spacing-sm);
        border-radius: var(--radius-md);
        transition: var(--transition-fast);
        opacity: 1;
      }

      .sidebar-toggle:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .sidebar.collapsed .sidebar-toggle {
        opacity: 0;
        pointer-events: none;
      }

      .sidebar-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow-y: auto;
        overflow-x: hidden;
      }

      .user-profile {
        padding: var(--spacing-lg);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        transition: var(--transition-normal);
      }

      .profile-avatar {
        font-size: 2.5rem;
        color: var(--primary-light);
        flex-shrink: 0;
      }

      .profile-info {
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .profile-info {
        opacity: 0;
        width: 0;
      }

      .profile-name {
        font-weight: 600;
        font-size: 1rem;
        color: var(--white);
        margin-bottom: var(--spacing-xs);
      }

      .profile-role {
        font-size: 0.875rem;
        color: rgba(255, 255, 255, 0.7);
      }

      .nav-menu {
        list-style: none;
        padding: var(--spacing-lg) 0;
        margin: 0;
        flex: 1;
      }

      .nav-item {
        margin-bottom: var(--spacing-xs);
        position: relative;
      }

      .nav-item.active .nav-link {
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        color: var(--white);
        box-shadow: var(--shadow-md);
      }

      .nav-item.active .nav-indicator {
        opacity: 1;
        transform: scaleY(1);
      }

      .nav-link {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        padding: var(--spacing-md) var(--spacing-lg);
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        transition: var(--transition-fast);
        border-radius: 0 25px 25px 0;
        margin-right: var(--spacing-md);
        position: relative;
        overflow: hidden;
      }

      .nav-link:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--white);
        transform: translateX(5px);
      }

      .nav-link i {
        font-size: 1.25rem;
        width: 24px;
        text-align: center;
        flex-shrink: 0;
      }

      .nav-text {
        font-weight: 500;
        white-space: nowrap;
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .nav-text {
        opacity: 0;
        width: 0;
      }

      .nav-badge {
        background: var(--primary-color);
        color: var(--white);
        font-size: 0.75rem;
        padding: 2px 6px;
        border-radius: var(--radius-sm);
        min-width: 20px;
        text-align: center;
        margin-left: auto;
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .nav-badge {
        opacity: 0;
        width: 0;
      }

      .nav-indicator {
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%) scaleY(0);
        width: 4px;
        height: 100%;
        background: var(--primary-light);
        border-radius: 0 2px 2px 0;
        transition: var(--transition-fast);
        opacity: 0;
      }

      .nav-divider {
        height: 1px;
        background: rgba(255, 255, 255, 0.1);
        margin: var(--spacing-md) var(--spacing-lg);
      }

      .nav-section {
        padding: var(--spacing-md) var(--spacing-lg) var(--spacing-sm);
      }

      .nav-section-title {
        font-size: 0.75rem;
        color: rgba(255, 255, 255, 0.5);
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 600;
        opacity: 1;
        transition: var(--transition-normal);
      }

      .sidebar.collapsed .nav-section-title {
        opacity: 0;
      }

      .sidebar-footer {
        padding: var(--spacing-lg);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      .quick-actions {
        display: flex;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
        justify-content: space-between;
      }

      .quick-action {
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: var(--white);
        width: 40px;
        height: 40px;
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: var(--transition-fast);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .quick-action:hover {
        background: var(--primary-color);
        transform: translateY(-2px);
      }

      .logout-btn {
        width: 100%;
        background: none;
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.8);
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: var(--transition-fast);
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        justify-content: center;
      }

      .logout-btn:hover {
        background: rgba(244, 67, 54, 0.2);
        border-color: var(--error);
        color: var(--white);
      }

      .sidebar.collapsed .logout-btn .nav-text {
        opacity: 0;
        width: 0;
      }

      /* Mobile Overlay */
      .sidebar-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition-normal);
      }

      .sidebar-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      /* Header */
      .header {
        background: var(--white);
        box-shadow: var(--shadow-sm);
        border-bottom: 1px solid rgba(45, 125, 50, 0.1);
        position: sticky;
        top: 0;
        z-index: 900;
        transition: var(--transition-normal);
      }

      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--spacing-md) var(--spacing-xl);
        gap: var(--spacing-lg);
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: var(--spacing-lg);
        flex: 1;
      }

      .mobile-menu-toggle {
        display: none;
        background: none;
        border: none;
        font-size: 1.25rem;
        color: var(--charcoal);
        cursor: pointer;
        padding: var(--spacing-sm);
        border-radius: var(--radius-md);
        transition: var(--transition-fast);
      }

      .mobile-menu-toggle:hover {
        background: var(--light-gray);
      }

      .page-header {
        flex: 1;
      }

      .page-title {
        font-family: var(--font-display);
        font-size: 2rem;
        font-weight: 600;
        color: var(--charcoal);
        margin-bottom: var(--spacing-xs);
      }

      .page-subtitle {
        color: var(--gray);
        font-size: 1rem;
        font-weight: 500;
      }

      .breadcrumb {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        color: var(--gray);
        font-size: 0.875rem;
        font-weight: 500;
        margin-bottom: var(--spacing-sm);
      }

      .breadcrumb i {
        color: var(--primary-color);
      }

      .breadcrumb .fas.fa-chevron-right {
        font-size: 0.75rem;
        color: var(--gray);
      }

      .header-actions {
        display: flex;
        gap: var(--spacing-md);
        align-items: center;
        flex-wrap: wrap;
      }

      /* Container */
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: var(--spacing-lg);
      }

      /* Stats Overview */
      .stats-overview {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-xl);
      }

      .stat-card {
        background: var(--white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow-md);
        border: 1px solid rgba(45, 125, 50, 0.1);
        transition: var(--transition-normal);
        position: relative;
        overflow: hidden;
      }

      .stat-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--primary-light)
        );
      }

      .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .stat-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: var(--spacing-md);
      }

      .stat-icon {
        width: 50px;
        height: 50px;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        border-radius: var(--radius-lg);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--white);
        font-size: 1.25rem;
        box-shadow: var(--shadow-md);
      }

      .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--charcoal);
        line-height: 1;
        margin-bottom: var(--spacing-xs);
      }

      .stat-label {
        color: var(--gray);
        font-weight: 500;
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .stat-trend {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        margin-top: var(--spacing-sm);
        font-size: 0.875rem;
        font-weight: 500;
      }

      .trend-up {
        color: var(--success);
      }

      .trend-down {
        color: var(--error);
      }

      /* Main Grid Layout */
      .ai-recommendations-grid {
        display: grid;
        grid-template-columns: 1fr 400px;
        gap: var(--spacing-xl);
        margin-bottom: var(--spacing-xl);
      }

      .recommendations-main {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-xl);
      }

      .recommendations-sidebar {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-xl);
      }

      /* Card Styles */
      .card {
        background: var(--white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-xl);
        box-shadow: var(--shadow-md);
        border: 1px solid rgba(45, 125, 50, 0.1);
        transition: var(--transition-normal);
      }

      .card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
      }

      .card-title {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--spacing-lg);
      }

      .card-title h2 {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        font-family: var(--font-display);
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--charcoal);
      }

      .card-title i {
        color: var(--primary-color);
      }

      .card-actions {
        display: flex;
        gap: var(--spacing-sm);
      }

      /* Buttons */
      .btn {
        padding: var(--spacing-md) var(--spacing-lg);
        border: none;
        border-radius: var(--radius-md);
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition-fast);
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-sm);
        text-decoration: none;
        font-family: var(--font-primary);
        white-space: nowrap;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        color: var(--white);
        box-shadow: var(--shadow-sm);
      }

      .btn-primary:hover {
        background: linear-gradient(
          135deg,
          var(--primary-dark),
          var(--primary-color)
        );
        box-shadow: var(--shadow-md);
        transform: translateY(-1px);
      }

      .btn-secondary {
        background: var(--light-gray);
        color: var(--charcoal);
        border: 1px solid rgba(45, 125, 50, 0.2);
      }

      .btn-secondary:hover {
        background: var(--gray);
        color: var(--white);
      }

      /* Recommendation Filters */
      .recommendation-filters {
        display: flex;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-lg);
        flex-wrap: wrap;
        align-items: center;
      }

      .filter-group {
        display: flex;
        gap: var(--spacing-sm);
        align-items: center;
      }

      .filter-label {
        font-weight: 600;
        color: var(--charcoal);
        font-size: 0.875rem;
      }

      .filter-select {
        padding: var(--spacing-sm) var(--spacing-md);
        border: 2px solid rgba(45, 125, 50, 0.2);
        border-radius: var(--radius-md);
        background: var(--white);
        color: var(--charcoal);
        font-family: var(--font-primary);
        font-weight: 500;
        transition: var(--transition-fast);
      }

      .filter-select:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(45, 125, 50, 0.1);
      }

      .filter-toggles {
        display: flex;
        gap: var(--spacing-xs);
        background: var(--light-gray);
        border-radius: var(--radius-md);
        padding: var(--spacing-xs);
      }

      .filter-toggle {
        padding: var(--spacing-sm) var(--spacing-md);
        border: none;
        background: none;
        cursor: pointer;
        border-radius: var(--radius-sm);
        transition: var(--transition-fast);
        color: var(--gray);
        font-weight: 500;
        font-size: 0.875rem;
      }

      .filter-toggle.active {
        background: var(--primary-color);
        color: var(--white);
      }

      .filter-toggle:hover {
        color: var(--primary-color);
      }

      /* Recommendation Cards */
      .recommendations-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-xl);
      }

      .recommendation-card {
        background: var(--white);
        border-radius: var(--radius-xl);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow-md);
        border: 1px solid rgba(45, 125, 50, 0.1);
        transition: var(--transition-normal);
        position: relative;
        overflow: hidden;
      }

      .recommendation-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--primary-light)
        );
      }

      .recommendation-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .recommendation-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: var(--spacing-md);
      }

      .recommendation-icon {
        width: 50px;
        height: 50px;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        border-radius: var(--radius-lg);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--white);
        font-size: 1.25rem;
        box-shadow: var(--shadow-md);
      }

      .recommendation-meta {
        text-align: right;
      }

      .recommendation-title {
        font-family: var(--font-display);
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--charcoal);
        margin-bottom: var(--spacing-xs);
      }

      .confidence-score {
        font-size: 0.875rem;
        font-weight: 600;
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: var(--radius-sm);
        display: inline-block;
      }

      .confidence-high {
        background: rgba(76, 175, 80, 0.1);
        color: var(--high-confidence);
      }

      .confidence-medium {
        background: rgba(255, 152, 0, 0.1);
        color: var(--medium-confidence);
      }

      .confidence-low {
        background: rgba(244, 67, 54, 0.1);
        color: var(--low-confidence);
      }

      .recommendation-content {
        margin-bottom: var(--spacing-md);
      }

      .recommendation-description {
        color: var(--dark-gray);
        line-height: 1.6;
        margin-bottom: var(--spacing-md);
      }

      .recommendation-metrics {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
      }

      .metric-item {
        background: linear-gradient(
          135deg,
          var(--light-gray) 0%,
          var(--white) 100%
        );
        padding: var(--spacing-sm);
        border-radius: var(--radius-md);
        text-align: center;
        border: 1px solid rgba(45, 125, 50, 0.1);
      }

      .metric-label {
        font-size: 0.75rem;
        color: var(--gray);
        margin-bottom: var(--spacing-xs);
        font-weight: 500;
      }

      .metric-value {
        font-size: 1rem;
        font-weight: 700;
        color: var(--charcoal);
      }

      .recommendation-actions {
        display: flex;
        gap: var(--spacing-sm);
        justify-content: space-between;
        align-items: center;
      }

      .action-buttons {
        display: flex;
        gap: var(--spacing-sm);
      }

      .btn-small {
        padding: var(--spacing-sm) var(--spacing-md);
        font-size: 0.875rem;
      }

      .priority-indicator {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        font-size: 0.875rem;
        font-weight: 600;
      }

      .priority-high {
        color: var(--error);
      }

      .priority-medium {
        color: var(--warning);
      }

      .priority-low {
        color: var(--success);
      }

      /* AI Insights */
      .ai-insights-container {
        display: grid;
        gap: var(--spacing-lg);
      }

      .insight-card {
        background: linear-gradient(
          135deg,
          var(--light-gray) 0%,
          var(--white) 100%
        );
        padding: var(--spacing-lg);
        border-radius: var(--radius-lg);
        border: 1px solid rgba(45, 125, 50, 0.1);
        transition: var(--transition-normal);
      }

      .insight-card:hover {
        transform: translateX(5px);
        box-shadow: var(--shadow-sm);
      }

      .insight-header {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-md);
      }

      .insight-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--white);
        font-size: 1rem;
      }

      .insight-title {
        font-weight: 600;
        color: var(--charcoal);
        font-size: 1rem;
      }

      .insight-content {
        color: var(--dark-gray);
        line-height: 1.6;
      }

      /* Charts Container */
      .chart-container {
        height: 300px;
        margin-bottom: var(--spacing-lg);
      }

      /* Performance Metrics */
      .performance-metrics {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-xl);
      }

      .metric-card {
        background: var(--white);
        border-radius: var(--radius-lg);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow-sm);
        border: 1px solid rgba(45, 125, 50, 0.1);
        text-align: center;
        transition: var(--transition-normal);
      }

      .metric-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      .metric-card-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: var(--spacing-xs);
      }

      .metric-card-label {
        color: var(--gray);
        font-weight: 500;
        font-size: 0.875rem;
      }

      .metric-card-change {
        font-size: 0.75rem;
        margin-top: var(--spacing-xs);
        font-weight: 500;
      }

      /* Chat Interface */
      .ai-chat-container {
        height: 400px;
        display: flex;
        flex-direction: column;
      }

      .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: var(--spacing-md);
        background: linear-gradient(
          135deg,
          var(--light-gray) 0%,
          var(--white) 100%
        );
        border-radius: var(--radius-lg);
        border: 1px solid rgba(45, 125, 50, 0.1);
        margin-bottom: var(--spacing-md);
      }

      .chat-message {
        display: flex;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
        align-items: flex-start;
      }

      .chat-message.user {
        flex-direction: row-reverse;
      }

      .message-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.875rem;
        flex-shrink: 0;
      }

      .chat-message.bot .message-avatar {
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        color: var(--white);
      }

      .chat-message.user .message-avatar {
        background: var(--info);
        color: var(--white);
      }

      .message-content {
        background: var(--white);
        padding: var(--spacing-md);
        border-radius: var(--radius-lg);
        max-width: 80%;
        box-shadow: var(--shadow-sm);
        border: 1px solid rgba(45, 125, 50, 0.1);
      }

      .chat-message.user .message-content {
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        color: var(--white);
      }

      .chat-input-container {
        display: flex;
        gap: var(--spacing-sm);
      }

      .chat-input-container input {
        flex: 1;
        padding: var(--spacing-md);
        border: 2px solid rgba(45, 125, 50, 0.2);
        border-radius: var(--radius-md);
        background: var(--white);
        color: var(--charcoal);
        font-family: var(--font-primary);
        font-weight: 500;
        transition: var(--transition-fast);
      }

      .chat-input-container input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(45, 125, 50, 0.1);
      }

      /* Loading States */
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        transition: var(--transition-normal);
      }

      .loading-overlay.hidden {
        opacity: 0;
        pointer-events: none;
      }

      .spinner {
        width: 60px;
        height: 60px;
        border: 4px solid var(--light-gray);
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        margin-top: var(--spacing-md);
        color: var(--charcoal);
        font-weight: 500;
      }

      /* Utility Classes */
      .hidden {
        display: none !important;
      }

      .text-center {
        text-align: center;
      }

      .mb-lg {
        margin-bottom: var(--spacing-lg);
      }

      .mt-lg {
        margin-top: var(--spacing-lg);
      }

      /* Responsive Design */
      @media (max-width: 1200px) {
        .ai-recommendations-grid {
          grid-template-columns: 1fr;
        }

        .recommendations-grid {
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .performance-metrics {
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }
      }

      @media (max-width: 768px) {
        body {
          padding-left: 0;
        }

        body.mobile {
          padding-left: 0;
        }

        .sidebar {
          transform: translateX(-100%);
        }

        .sidebar.mobile-open {
          transform: translateX(0);
        }

        .mobile-menu-toggle {
          display: block;
        }

        .container {
          padding: var(--spacing-md);
        }

        .header-actions {
          flex-direction: column;
          width: 100%;
          gap: var(--spacing-sm);
        }

        .stats-overview {
          grid-template-columns: 1fr;
        }

        .recommendations-grid {
          grid-template-columns: 1fr;
        }

        .recommendation-filters {
          flex-direction: column;
          align-items: flex-start;
        }

        .message-content {
          max-width: 90%;
        }

        .ai-chat-container {
          height: 300px;
        }
      }

      @media (max-width: 480px) {
        .sidebar {
          width: 100%;
        }

        .card-actions {
          flex-direction: column;
        }

        .recommendation-actions {
          flex-direction: column;
          gap: var(--spacing-md);
        }

        .action-buttons {
          justify-content: center;
        }
      }

      /* Animations */
      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .slide-in-up {
        animation: slideInUp 0.6s ease-out forwards;
      }

      .fade-in {
        animation: fadeIn 0.5s ease-out forwards;
      }

      /* Stagger animations for cards */
      .recommendation-card:nth-child(1) {
        animation-delay: 0.1s;
      }
      .recommendation-card:nth-child(2) {
        animation-delay: 0.2s;
      }
      .recommendation-card:nth-child(3) {
        animation-delay: 0.3s;
      }
      .recommendation-card:nth-child(4) {
        animation-delay: 0.4s;
      }
    </style>
  </head>

  <body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
      <div class="spinner"></div>
      <div class="loading-text">Generating AI recommendations...</div>
    </div>

    <!-- Sidebar Navigation -->
    <nav id="sidebar" class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="logo-icon">
            <i class="fas fa-seedling"></i>
          </div>
          <span class="logo-text">Talazo AgriFinance</span>
        </div>
        <button id="sidebar-toggle" class="sidebar-toggle">
          <i class="fas fa-bars"></i>
        </button>
      </div>

      <div class="sidebar-content">
        <div class="user-profile">
          <div class="profile-avatar">
            <i class="fas fa-user-circle"></i>
          </div>
          <div class="profile-info">
            <div class="profile-name">Financial Officer</div>
            <div class="profile-role">AgriFinance Division</div>
          </div>
        </div>

        <ul class="nav-menu">
          <li class="nav-item">
            <a href="/dashboard" class="nav-link">
              <i class="fas fa-tachometer-alt"></i>
              <span class="nav-text">Dashboard</span>
              <div class="nav-indicator"></div>
            </a>
          </li>
          <li class="nav-item">
            <a href="/farmers" class="nav-link">
              <i class="fas fa-users"></i>
              <span class="nav-text">Farmers</span>
              <div class="nav-badge">156</div>
            </a>
          </li>
          <li class="nav-item">
            <a href="/loans" class="nav-link">
              <i class="fas fa-hand-holding-usd"></i>
              <span class="nav-text">Loans</span>
              <div class="nav-badge">23</div>
            </a>
          </li>
          <li class="nav-item">
            <a href="/insurance" class="nav-link">
              <i class="fas fa-shield-alt"></i>
              <span class="nav-text">Insurance</span>
              <div class="nav-badge">89</div>
            </a>
          </li>
          <li class="nav-item">
            <a href="/soil_analysis" class="nav-link">
              <i class="fas fa-vial"></i>
              <span class="nav-text">Soil Analysis</span>
            </a>
          </li>
          <li class="nav-item active">
            <a href="/ai_recommendations" class="nav-link">
              <i class="fas fa-brain"></i>
              <span class="nav-text">AI Recommendations</span>
              <div class="nav-badge">12</div>
              <div class="nav-indicator"></div>
            </a>
          </li>

          <li class="nav-divider"></li>

          <li class="nav-section">
            <span class="nav-section-title">Analytics</span>
          </li>
          <li class="nav-item">
            <a href="/reports" class="nav-link">
              <i class="fas fa-chart-bar"></i>
              <span class="nav-text">Reports</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="/trends" class="nav-link">
              <i class="fas fa-chart-line"></i>
              <span class="nav-text">Market Trends</span>
            </a>
          </li>

          <li class="nav-divider"></li>

          <li class="nav-section">
            <span class="nav-section-title">System</span>
          </li>
          <li class="nav-item">
            <a href="/settings" class="nav-link">
              <i class="fas fa-cog"></i>
              <span class="nav-text">Settings</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="/help" class="nav-link">
              <i class="fas fa-question-circle"></i>
              <span class="nav-text">Help & Support</span>
            </a>
          </li>
        </ul>

        <div class="sidebar-footer">
          <div class="quick-actions">
            <button class="quick-action" title="Generate Recommendations">
              <i class="fas fa-magic"></i>
            </button>
            <button class="quick-action" title="Export Report">
              <i class="fas fa-download"></i>
            </button>
            <button class="quick-action" title="AI Assistant">
              <i class="fas fa-robot"></i>
            </button>
          </div>
          <button class="logout-btn">
            <i class="fas fa-sign-out-alt"></i>
            <span class="nav-text">Logout</span>
          </button>
        </div>
      </div>
    </nav>

    <!-- Mobile Overlay -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>

    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="header-left">
          <button id="mobile-menu-toggle" class="mobile-menu-toggle">
            <i class="fas fa-bars"></i>
          </button>
          <div class="page-header">
            <div class="breadcrumb">
              <i class="fas fa-brain"></i>
              <span>AI Recommendations</span>
              <i class="fas fa-chevron-right"></i>
              <span>Intelligent Insights</span>
            </div>
            <h1 class="page-title">AI Recommendations</h1>
            <p class="page-subtitle">
              Intelligent insights and recommendations for optimal farming
              decisions
            </p>
          </div>
        </div>
        <div class="header-actions">
          <button id="refresh-recommendations" class="btn btn-primary">
            <i class="fas fa-sync"></i> Refresh Recommendations
          </button>
          <button id="export-recommendations" class="btn btn-secondary">
            <i class="fas fa-download"></i> Export
          </button>
        </div>
      </div>
    </header>

    <div class="container">
      <!-- Stats Overview -->
      <div class="stats-overview">
        <div class="stat-card slide-in-up">
          <div class="stat-header">
            <div>
              <div class="stat-value">12</div>
              <div class="stat-label">Active Recommendations</div>
              <div class="stat-trend trend-up">
                <i class="fas fa-arrow-up"></i>
                <span>3 new this week</span>
              </div>
            </div>
            <div class="stat-icon">
              <i class="fas fa-lightbulb"></i>
            </div>
          </div>
        </div>

        <div class="stat-card slide-in-up">
          <div class="stat-header">
            <div>
              <div class="stat-value">94%</div>
              <div class="stat-label">Avg Confidence Score</div>
              <div class="stat-trend trend-up">
                <i class="fas fa-arrow-up"></i>
                <span>High accuracy rate</span>
              </div>
            </div>
            <div class="stat-icon">
              <i class="fas fa-chart-line"></i>
            </div>
          </div>
        </div>

        <div class="stat-card slide-in-up">
          <div class="stat-header">
            <div>
              <div class="stat-value">$24,500</div>
              <div class="stat-label">Potential ROI</div>
              <div class="stat-trend trend-up">
                <i class="fas fa-arrow-up"></i>
                <span>Following recommendations</span>
              </div>
            </div>
            <div class="stat-icon">
              <i class="fas fa-dollar-sign"></i>
            </div>
          </div>
        </div>

        <div class="stat-card slide-in-up">
          <div class="stat-header">
            <div>
              <div class="stat-value">8.7</div>
              <div class="stat-label">AI Engine Score</div>
              <div class="stat-trend trend-up">
                <i class="fas fa-arrow-up"></i>
                <span>Continuously improving</span>
              </div>
            </div>
            <div class="stat-icon">
              <i class="fas fa-brain"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Main AI Recommendations Grid -->
      <div class="ai-recommendations-grid">
        <!-- Main Content -->
        <div class="recommendations-main">
          <!-- Recommendation Filters -->
          <div class="card fade-in">
            <div class="card-title">
              <h2>
                <i class="fas fa-filter"></i>
                <span>Recommendation Filters</span>
              </h2>
            </div>

            <div class="recommendation-filters">
              <div class="filter-group">
                <span class="filter-label">Category:</span>
                <select id="category-filter" class="filter-select">
                  <option value="all">All Categories</option>
                  <option value="crop">Crop Selection</option>
                  <option value="soil">Soil Treatment</option>
                  <option value="irrigation">Irrigation</option>
                  <option value="financial">Financial Planning</option>
                  <option value="market">Market Strategy</option>
                </select>
              </div>

              <div class="filter-group">
                <span class="filter-label">Priority:</span>
                <div class="filter-toggles">
                  <button class="filter-toggle active" data-priority="all">
                    All
                  </button>
                  <button class="filter-toggle" data-priority="high">
                    High
                  </button>
                  <button class="filter-toggle" data-priority="medium">
                    Medium
                  </button>
                  <button class="filter-toggle" data-priority="low">Low</button>
                </div>
              </div>

              <div class="filter-group">
                <span class="filter-label">Confidence:</span>
                <select id="confidence-filter" class="filter-select">
                  <option value="all">All Levels</option>
                  <option value="high">High (90%+)</option>
                  <option value="medium">Medium (70-89%)</option>
                  <option value="low">Low (<70%)</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Recommendations Grid -->
          <div class="card fade-in">
            <div class="card-title">
              <h2>
                <i class="fas fa-magic"></i>
                <span>AI-Generated Recommendations</span>
              </h2>
              <div class="card-actions">
                <button id="generate-new" class="btn btn-primary">
                  <i class="fas fa-plus"></i> Generate New
                </button>
              </div>
            </div>

            <div id="recommendations-grid" class="recommendations-grid">
              <!-- Crop Selection Recommendation -->
              <div
                class="recommendation-card slide-in-up"
                data-category="crop"
                data-priority="high"
              >
                <div class="recommendation-header">
                  <div class="recommendation-icon">
                    <i class="fas fa-seedling"></i>
                  </div>
                  <div class="recommendation-meta">
                    <div class="recommendation-title">Crop Selection</div>
                    <div class="confidence-score confidence-high">
                      94% Confidence
                    </div>
                  </div>
                </div>
                <div class="recommendation-content">
                  <div class="recommendation-description">
                    Based on your soil analysis and market trends, we recommend
                    planting
                    <strong>Maize (Hybrid varieties)</strong> as your primary
                    crop this season. Your soil pH of 6.8 and optimal nutrient
                    levels make it ideal for high-yield varieties.
                  </div>
                  <div class="recommendation-metrics">
                    <div class="metric-item">
                      <div class="metric-label">Expected Yield</div>
                      <div class="metric-value">4.8 t/ha</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Market Price</div>
                      <div class="metric-value">$320/ton</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">ROI</div>
                      <div class="metric-value">185%</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Risk Level</div>
                      <div class="metric-value">Low</div>
                    </div>
                  </div>
                </div>
                <div class="recommendation-actions">
                  <div class="action-buttons">
                    <button class="btn btn-primary btn-small">Apply</button>
                    <button class="btn btn-secondary btn-small">Details</button>
                  </div>
                  <div class="priority-indicator priority-high">
                    <i class="fas fa-exclamation-circle"></i>
                    High Priority
                  </div>
                </div>
              </div>

              <!-- Soil Treatment Recommendation -->
              <div
                class="recommendation-card slide-in-up"
                data-category="soil"
                data-priority="medium"
              >
                <div class="recommendation-header">
                  <div class="recommendation-icon">
                    <i class="fas fa-flask"></i>
                  </div>
                  <div class="recommendation-meta">
                    <div class="recommendation-title">Soil Treatment</div>
                    <div class="confidence-score confidence-high">
                      87% Confidence
                    </div>
                  </div>
                </div>
                <div class="recommendation-content">
                  <div class="recommendation-description">
                    Apply phosphorus-rich fertilizer to improve nutrient balance
                    and maximize crop yield potential. Your soil test shows
                    slightly low phosphorus levels.
                  </div>
                  <div class="recommendation-metrics">
                    <div class="metric-item">
                      <div class="metric-label">Fertilizer Type</div>
                      <div class="metric-value">NPK 10-20-10</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Application Rate</div>
                      <div class="metric-value">150 kg/ha</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Yield Increase</div>
                      <div class="metric-value">+15%</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Cost</div>
                      <div class="metric-value">$280/ha</div>
                    </div>
                  </div>
                </div>
                <div class="recommendation-actions">
                  <div class="action-buttons">
                    <button class="btn btn-primary btn-small">Apply</button>
                    <button class="btn btn-secondary btn-small">Details</button>
                  </div>
                  <div class="priority-indicator priority-medium">
                    <i class="fas fa-minus-circle"></i>
                    Medium Priority
                  </div>
                </div>
              </div>

              <!-- Irrigation Recommendation -->
              <div
                class="recommendation-card slide-in-up"
                data-category="irrigation"
                data-priority="high"
              >
                <div class="recommendation-header">
                  <div class="recommendation-icon">
                    <i class="fas fa-tint"></i>
                  </div>
                  <div class="recommendation-meta">
                    <div class="recommendation-title">
                      Irrigation Optimization
                    </div>
                    <div class="confidence-score confidence-high">
                      91% Confidence
                    </div>
                  </div>
                </div>
                <div class="recommendation-content">
                  <div class="recommendation-description">
                    Implement drip irrigation system to optimize water usage and
                    maintain consistent soil moisture levels during the growing
                    season.
                  </div>
                  <div class="recommendation-metrics">
                    <div class="metric-item">
                      <div class="metric-label">Water Savings</div>
                      <div class="metric-value">30%</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Efficiency Gain</div>
                      <div class="metric-value">+25%</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">ROI Period</div>
                      <div class="metric-value">12 months</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Installation Cost</div>
                      <div class="metric-value">$1,200/ha</div>
                    </div>
                  </div>
                </div>
                <div class="recommendation-actions">
                  <div class="action-buttons">
                    <button class="btn btn-primary btn-small">Apply</button>
                    <button class="btn btn-secondary btn-small">Details</button>
                  </div>
                  <div class="priority-indicator priority-high">
                    <i class="fas fa-exclamation-circle"></i>
                    High Priority
                  </div>
                </div>
              </div>

              <!-- Financial Planning Recommendation -->
              <div
                class="recommendation-card slide-in-up"
                data-category="financial"
                data-priority="medium"
              >
                <div class="recommendation-header">
                  <div class="recommendation-icon">
                    <i class="fas fa-dollar-sign"></i>
                  </div>
                  <div class="recommendation-meta">
                    <div class="recommendation-title">Financial Planning</div>
                    <div class="confidence-score confidence-high">
                      89% Confidence
                    </div>
                  </div>
                </div>
                <div class="recommendation-content">
                  <div class="recommendation-description">
                    Consider taking a seasonal loan of $15,000 to maximize your
                    farming potential this season. Your soil health score
                    qualifies you for preferential rates.
                  </div>
                  <div class="recommendation-metrics">
                    <div class="metric-item">
                      <div class="metric-label">Loan Amount</div>
                      <div class="metric-value">$15,000</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Interest Rate</div>
                      <div class="metric-value">8.5% APR</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Term</div>
                      <div class="metric-value">24 months</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Pre-approval</div>
                      <div class="metric-value">Ready</div>
                    </div>
                  </div>
                </div>
                <div class="recommendation-actions">
                  <div class="action-buttons">
                    <button class="btn btn-primary btn-small">Apply</button>
                    <button class="btn btn-secondary btn-small">Details</button>
                  </div>
                  <div class="priority-indicator priority-medium">
                    <i class="fas fa-minus-circle"></i>
                    Medium Priority
                  </div>
                </div>
              </div>

              <!-- Market Strategy Recommendation -->
              <div
                class="recommendation-card slide-in-up"
                data-category="market"
                data-priority="low"
              >
                <div class="recommendation-header">
                  <div class="recommendation-icon">
                    <i class="fas fa-chart-line"></i>
                  </div>
                  <div class="recommendation-meta">
                    <div class="recommendation-title">Market Strategy</div>
                    <div class="confidence-score confidence-medium">
                      76% Confidence
                    </div>
                  </div>
                </div>
                <div class="recommendation-content">
                  <div class="recommendation-description">
                    Diversify your crop portfolio by allocating 20% of land to
                    soybeans. Market projections show strong demand and price
                    stability for the next season.
                  </div>
                  <div class="recommendation-metrics">
                    <div class="metric-item">
                      <div class="metric-label">Price Trend</div>
                      <div class="metric-value">+8% YoY</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Demand Outlook</div>
                      <div class="metric-value">Strong</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Risk Reduction</div>
                      <div class="metric-value">25%</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Expected Yield</div>
                      <div class="metric-value">2.8 t/ha</div>
                    </div>
                  </div>
                </div>
                <div class="recommendation-actions">
                  <div class="action-buttons">
                    <button class="btn btn-primary btn-small">Apply</button>
                    <button class="btn btn-secondary btn-small">Details</button>
                  </div>
                  <div class="priority-indicator priority-low">
                    <i class="fas fa-check-circle"></i>
                    Low Priority
                  </div>
                </div>
              </div>

              <!-- Risk Management Recommendation -->
              <div
                class="recommendation-card slide-in-up"
                data-category="financial"
                data-priority="high"
              >
                <div class="recommendation-header">
                  <div class="recommendation-icon">
                    <i class="fas fa-shield-alt"></i>
                  </div>
                  <div class="recommendation-meta">
                    <div class="recommendation-title">Risk Management</div>
                    <div class="confidence-score confidence-high">
                      92% Confidence
                    </div>
                  </div>
                </div>
                <div class="recommendation-content">
                  <div class="recommendation-description">
                    Upgrade to comprehensive crop insurance to protect against
                    weather-related losses. Your soil health score qualifies you
                    for reduced premium rates.
                  </div>
                  <div class="recommendation-metrics">
                    <div class="metric-item">
                      <div class="metric-label">Premium Rate</div>
                      <div class="metric-value">$145/ha</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Coverage</div>
                      <div class="metric-value">90%</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Discount</div>
                      <div class="metric-value">15%</div>
                    </div>
                    <div class="metric-item">
                      <div class="metric-label">Protection</div>
                      <div class="metric-value">Full</div>
                    </div>
                  </div>
                </div>
                <div class="recommendation-actions">
                  <div class="action-buttons">
                    <button class="btn btn-primary btn-small">Apply</button>
                    <button class="btn btn-secondary btn-small">Details</button>
                  </div>
                  <div class="priority-indicator priority-high">
                    <i class="fas fa-exclamation-circle"></i>
                    High Priority
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Performance Metrics -->
          <div class="card fade-in">
            <div class="card-title">
              <h2>
                <i class="fas fa-chart-bar"></i>
                <span>Recommendation Performance</span>
              </h2>
            </div>

            <div class="performance-metrics">
              <div class="metric-card">
                <div class="metric-card-value">87%</div>
                <div class="metric-card-label">Success Rate</div>
                <div class="metric-card-change trend-up">
                  +5% vs last season
                </div>
              </div>
              <div class="metric-card">
                <div class="metric-card-value">$18,500</div>
                <div class="metric-card-label">Avg ROI</div>
                <div class="metric-card-change trend-up">+12% improvement</div>
              </div>
              <div class="metric-card">
                <div class="metric-card-value">42</div>
                <div class="metric-card-label">Implemented</div>
                <div class="metric-card-change trend-up">8 this month</div>
              </div>
              <div class="metric-card">
                <div class="metric-card-value">3.2 days</div>
                <div class="metric-card-label">Avg Response Time</div>
                <div class="metric-card-change trend-down">
                  -0.8 days faster
                </div>
              </div>
            </div>

            <div class="chart-container">
              <div id="performance-chart"></div>
            </div>
          </div>
        </div>

        <!-- Sidebar Content -->
        <div class="recommendations-sidebar">
          <!-- AI Insights -->
          <div class="card fade-in">
            <div class="card-title">
              <h2>
                <i class="fas fa-lightbulb"></i>
                <span>AI Insights</span>
              </h2>
            </div>

            <div class="ai-insights-container">
              <div class="insight-card">
                <div class="insight-header">
                  <div class="insight-icon">
                    <i class="fas fa-chart-line"></i>
                  </div>
                  <div class="insight-title">Market Trends</div>
                </div>
                <div class="insight-content">
                  Maize prices are expected to increase by 12% in the next
                  quarter due to high demand and favorable export conditions.
                  Consider increasing allocation.
                </div>
              </div>

              <div class="insight-card">
                <div class="insight-header">
                  <div class="insight-icon">
                    <i class="fas fa-cloud-rain"></i>
                  </div>
                  <div class="insight-title">Weather Forecast</div>
                </div>
                <div class="insight-content">
                  Optimal rainfall expected for the next 3 months - perfect for
                  crop establishment. Adjust irrigation schedules accordingly.
                </div>
              </div>

              <div class="insight-card">
                <div class="insight-header">
                  <div class="insight-icon">
                    <i class="fas fa-shield-alt"></i>
                  </div>
                  <div class="insight-title">Risk Assessment</div>
                </div>
                <div class="insight-content">
                  Your farm shows low risk indicators with excellent soil health
                  metrics. This qualifies you for premium financial products.
                </div>
              </div>

              <div class="insight-card">
                <div class="insight-header">
                  <div class="insight-icon">
                    <i class="fas fa-leaf"></i>
                  </div>
                  <div class="insight-title">Sustainability Score</div>
                </div>
                <div class="insight-content">
                  Your farming practices show a 94% sustainability rating.
                  Consider carbon credit opportunities for additional income.
                </div>
              </div>
            </div>
          </div>

          <!-- AI Chat Assistant -->
          <div class="card fade-in">
            <div class="card-title">
              <h2>
                <i class="fas fa-robot"></i>
                <span>AI Assistant</span>
              </h2>
              <div class="card-actions">
                <button id="clear-chat" class="btn btn-secondary">
                  <i class="fas fa-trash"></i> Clear
                </button>
              </div>
            </div>

            <div class="ai-chat-container">
              <div class="chat-messages" id="chat-messages">
                <div class="chat-message bot">
                  <div class="message-avatar">
                    <i class="fas fa-robot"></i>
                  </div>
                  <div class="message-content">
                    <p>
                      Hello! I can help you understand and implement AI
                      recommendations. Ask me about any recommendation details,
                      ROI calculations, or implementation strategies.
                    </p>
                  </div>
                </div>
              </div>

              <div class="chat-input-container">
                <input
                  type="text"
                  id="chat-input"
                  placeholder="Ask about recommendations..."
                />
                <button id="send-message" class="btn btn-primary">
                  <i class="fas fa-paper-plane"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript -->
    <script>
      // AI Recommendations Configuration and State Management
      const AIRecommendationsConfig = {
        refreshInterval: 60000,
        animationDelay: 100,
      };

      let aiState = {
        currentFilters: {
          category: "all",
          priority: "all",
          confidence: "all",
        },
        recommendations: [],
        chatHistory: [],
        performanceData: null,
      };

      // Initialize Application
      document.addEventListener("DOMContentLoaded", function () {
        initializeAIRecommendationsPage();
        setupEventListeners();
        setupSidebar();
        initializeCharts();
        initializeAnimations();
      });

      function initializeAIRecommendationsPage() {
        console.log("🧠 Talazo AgriFinance - AI Recommendations Initialized");
        loadRecommendations();
      }

      function setupEventListeners() {
        // Sidebar toggle
        document
          .getElementById("sidebar-toggle")
          .addEventListener("click", toggleSidebar);
        document
          .getElementById("mobile-menu-toggle")
          .addEventListener("click", toggleMobileSidebar);
        document
          .getElementById("sidebar-overlay")
          .addEventListener("click", closeMobileSidebar);

        // Navigation links
        document.querySelectorAll(".nav-link").forEach((link) => {
          link.addEventListener("click", function (e) {
            document.querySelectorAll(".nav-item").forEach((item) => {
              item.classList.remove("active");
            });
            this.closest(".nav-item").classList.add("active");
            if (window.innerWidth <= 768) {
              closeMobileSidebar();
            }
          });
        });

        // Header actions
        document
          .getElementById("refresh-recommendations")
          .addEventListener("click", refreshRecommendations);
        document
          .getElementById("export-recommendations")
          .addEventListener("click", exportRecommendations);
        document
          .getElementById("generate-new")
          .addEventListener("click", generateNewRecommendations);

        // Filter controls
        document
          .getElementById("category-filter")
          .addEventListener("change", function (e) {
            aiState.currentFilters.category = e.target.value;
            filterRecommendations();
          });

        document
          .getElementById("confidence-filter")
          .addEventListener("change", function (e) {
            aiState.currentFilters.confidence = e.target.value;
            filterRecommendations();
          });

        document.querySelectorAll(".filter-toggle").forEach((toggle) => {
          toggle.addEventListener("click", function () {
            document
              .querySelectorAll(".filter-toggle")
              .forEach((t) => t.classList.remove("active"));
            this.classList.add("active");
            aiState.currentFilters.priority = this.dataset.priority;
            filterRecommendations();
          });
        });

        // Recommendation actions
        document.addEventListener("click", function (e) {
          if (e.target.matches(".btn-small")) {
            const action = e.target.textContent.toLowerCase();
            const card = e.target.closest(".recommendation-card");
            const title = card.querySelector(
              ".recommendation-title"
            ).textContent;

            if (action === "apply") {
              applyRecommendation(title);
            } else if (action === "details") {
              showRecommendationDetails(title);
            }
          }
        });

        // Chat functionality
        document
          .getElementById("send-message")
          .addEventListener("click", sendChatMessage);
        document
          .getElementById("chat-input")
          .addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              sendChatMessage();
            }
          });
        document
          .getElementById("clear-chat")
          .addEventListener("click", clearChat);

        // Window resize
        window.addEventListener("resize", handleResize);
      }

      function setupSidebar() {
        // Restore sidebar state
        const isCollapsed = localStorage.getItem("sidebarCollapsed") === "true";
        if (isCollapsed) {
          document.getElementById("sidebar").classList.add("collapsed");
          document.body.classList.add("sidebar-collapsed");
        }
        handleResize();
      }

      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        const body = document.body;

        sidebar.classList.toggle("collapsed");
        body.classList.toggle("sidebar-collapsed");

        localStorage.setItem(
          "sidebarCollapsed",
          sidebar.classList.contains("collapsed")
        );
      }

      function toggleMobileSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebar-overlay");

        sidebar.classList.toggle("mobile-open");
        overlay.classList.toggle("active");
        document.body.style.overflow = sidebar.classList.contains("mobile-open")
          ? "hidden"
          : "";
      }

      function closeMobileSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebar-overlay");

        sidebar.classList.remove("mobile-open");
        overlay.classList.remove("active");
        document.body.style.overflow = "";
      }

      function handleResize() {
        const sidebar = document.getElementById("sidebar");
        const body = document.body;

        if (window.innerWidth <= 768) {
          body.classList.add("mobile");
          closeMobileSidebar();
        } else {
          body.classList.remove("mobile");
          sidebar.classList.remove("mobile-open");
          document.getElementById("sidebar-overlay").classList.remove("active");
          document.body.style.overflow = "";
        }

        // Resize charts
        setTimeout(() => {
          if (typeof Plotly !== "undefined") {
            Plotly.Plots.resize("performance-chart");
          }
        }, 100);
      }

      function initializeCharts() {
        createPerformanceChart();
      }

      function createPerformanceChart() {
        const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun"];
        const successRate = [82, 85, 88, 86, 90, 87];
        const implementationRate = [78, 81, 84, 85, 88, 92];
        const roi = [15200, 16800, 17500, 18200, 19100, 18500];

        const trace1 = {
          x: months,
          y: successRate,
          type: "scatter",
          mode: "lines+markers",
          name: "Success Rate (%)",
          line: { color: "#4caf50", width: 3 },
          marker: { size: 8 },
        };

        const trace2 = {
          x: months,
          y: implementationRate,
          type: "scatter",
          mode: "lines+markers",
          name: "Implementation Rate (%)",
          line: { color: "#2196f3", width: 3 },
          marker: { size: 8 },
        };

        const trace3 = {
          x: months,
          y: roi,
          type: "scatter",
          mode: "lines+markers",
          name: "Average ROI ($)",
          yaxis: "y2",
          line: { color: "#ff9800", width: 3 },
          marker: { size: 8 },
        };

        const layout = {
          title: {
            text: "AI Recommendations Performance Trends",
            font: { family: "Inter, sans-serif", size: 16 },
          },
          xaxis: { title: "Month" },
          yaxis: {
            title: "Percentage (%)",
            side: "left",
          },
          yaxis2: {
            title: "ROI ($)",
            side: "right",
            overlaying: "y",
          },
          legend: {
            orientation: "h",
            y: -0.2,
          },
          margin: { t: 50, b: 80, l: 50, r: 50 },
          paper_bgcolor: "rgba(0,0,0,0)",
          plot_bgcolor: "rgba(0,0,0,0)",
          font: { family: "Inter, sans-serif" },
        };

        const config = {
          displayModeBar: false,
          responsive: true,
        };

        Plotly.newPlot(
          "performance-chart",
          [trace1, trace2, trace3],
          layout,
          config
        );
      }

      function loadRecommendations() {
        // This would typically load from an API
        aiState.recommendations = document.querySelectorAll(
          ".recommendation-card"
        );
        filterRecommendations();
      }

      function filterRecommendations() {
        const cards = document.querySelectorAll(".recommendation-card");

        cards.forEach((card) => {
          const category = card.dataset.category;
          const priority = card.dataset.priority;
          const confidenceElement = card.querySelector(".confidence-score");

          let confidence = "high";
          if (confidenceElement) {
            const confidenceText = confidenceElement.textContent;
            const confidenceValue = parseInt(confidenceText);
            if (confidenceValue >= 90) confidence = "high";
            else if (confidenceValue >= 70) confidence = "medium";
            else confidence = "low";
          }

          const showCategory =
            aiState.currentFilters.category === "all" ||
            category === aiState.currentFilters.category;
          const showPriority =
            aiState.currentFilters.priority === "all" ||
            priority === aiState.currentFilters.priority;
          const showConfidence =
            aiState.currentFilters.confidence === "all" ||
            confidence === aiState.currentFilters.confidence;

          if (showCategory && showPriority && showConfidence) {
            card.style.display = "block";
            card.style.animation = "fadeIn 0.5s ease-out";
          } else {
            card.style.display = "none";
          }
        });
      }

      function refreshRecommendations() {
        showLoadingOverlay();

        setTimeout(() => {
          // Simulate refreshing recommendations
          loadRecommendations();
          hideLoadingOverlay();
          showToast("Recommendations refreshed successfully!", "success");
        }, 2000);
      }

      function exportRecommendations() {
        showToast("Exporting recommendations...", "info");

        setTimeout(() => {
          // Simulate export functionality
          showToast("Recommendations exported successfully!", "success");
        }, 1000);
      }

      function generateNewRecommendations() {
        showLoadingOverlay();

        setTimeout(() => {
          // Simulate generating new recommendations
          hideLoadingOverlay();
          showToast("New recommendations generated!", "success");
        }, 3000);
      }

      function applyRecommendation(title) {
        showLoadingOverlay();

        setTimeout(() => {
          hideLoadingOverlay();
          showToast(`Applied recommendation: ${title}`, "success");
        }, 1500);
      }

      function showRecommendationDetails(title) {
        showToast(`Showing details for: ${title}`, "info");
        // This would typically open a modal with detailed information
      }

      // Chat functionality
      function sendChatMessage() {
        const input = document.getElementById("chat-input");
        const message = input.value.trim();

        if (!message) {
          return;
        }

        // Add user message to chat
        addChatMessage(message, "user");
        input.value = "";

        // Generate AI response
        setTimeout(() => {
          const response = generateAIResponse(message);
          addChatMessage(response, "bot");
        }, 1000);
      }

      function addChatMessage(message, sender) {
        const chatMessages = document.getElementById("chat-messages");
        const messageDiv = document.createElement("div");
        messageDiv.className = `chat-message ${sender}`;

        const avatar =
          sender === "bot"
            ? '<i class="fas fa-robot"></i>'
            : '<i class="fas fa-user"></i>';

        messageDiv.innerHTML = `
          <div class="message-avatar">
            ${avatar}
          </div>
          <div class="message-content">
            <p>${message}</p>
          </div>
        `;

        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;

        // Store in chat history
        aiState.chatHistory.push({ message, sender, timestamp: new Date() });
      }

      function generateAIResponse(userMessage) {
        const message = userMessage.toLowerCase();

        if (message.includes("crop") || message.includes("maize")) {
          return "Our crop selection recommendation is based on your soil pH of 6.8, optimal nutrient levels, and current market prices. Maize hybrid varieties are projected to yield 4.8 tons per hectare with a 185% ROI.";
        }

        if (message.includes("soil") || message.includes("fertilizer")) {
          return "The soil treatment recommendation suggests NPK 10-20-10 fertilizer at 150kg/ha. This will address your slightly low phosphorus levels and is expected to increase yield by 15%.";
        }

        if (message.includes("irrigation") || message.includes("water")) {
          return "Drip irrigation is recommended to reduce water usage by 30% while maintaining optimal soil moisture. The system will pay for itself in 12 months through water savings and increased yield.";
        }

        if (message.includes("loan") || message.includes("financial")) {
          return "Based on your soil health score of 85, you qualify for a preferential loan rate of 8.5% APR. The recommended $15,000 seasonal loan can maximize your farming potential this season.";
        }

        if (message.includes("confidence") || message.includes("accuracy")) {
          return "Our AI recommendations have an average confidence score of 94% and success rate of 87%. The system continuously learns from farmer outcomes to improve accuracy.";
        }

        if (message.includes("priority") || message.includes("implement")) {
          return "I recommend implementing high-priority recommendations first: crop selection and irrigation optimization. These have the highest ROI and lowest risk. Medium-priority items like soil treatment can follow.";
        }

        if (message.includes("roi") || message.includes("return")) {
          return "Current recommendations show potential ROI ranging from 85% to 185%. The crop selection recommendation offers the highest return, while irrigation provides long-term benefits.";
        }

        // Default responses
        const defaultResponses = [
          "I can help you understand any of the AI recommendations. Which one would you like to know more about?",
          "Our recommendations are based on soil analysis, market trends, and weather forecasts. What specific aspect interests you?",
          "Feel free to ask about implementation strategies, ROI calculations, or priority rankings for any recommendation.",
          "I'm here to help you make the most of our AI insights. What would you like to explore?",
          "Each recommendation comes with detailed metrics and confidence scores. Which one would you like me to explain?",
        ];

        return defaultResponses[
          Math.floor(Math.random() * defaultResponses.length)
        ];
      }

      function clearChat() {
        const chatMessages = document.getElementById("chat-messages");
        chatMessages.innerHTML = `
          <div class="chat-message bot">
            <div class="message-avatar">
              <i class="fas fa-robot"></i>
            </div>
            <div class="message-content">
              <p>
                Hello! I can help you understand and implement AI recommendations.
                Ask me about any recommendation details, ROI calculations, or implementation strategies.
              </p>
            </div>
          </div>
        `;

        aiState.chatHistory = [];
        showToast("Chat cleared!", "info");
      }

      function initializeAnimations() {
        const cards = document.querySelectorAll(".slide-in-up, .fade-in");
        cards.forEach((card, index) => {
          setTimeout(() => {
            card.style.opacity = "0";
            card.style.transform = "translateY(20px)";
            card.style.transition = "all 0.6s ease-out";

            setTimeout(() => {
              card.style.opacity = "1";
              card.style.transform = "translateY(0)";
            }, 50);
          }, index * AIRecommendationsConfig.animationDelay);
        });
      }

      function showLoadingOverlay() {
        document.getElementById("loading-overlay").classList.remove("hidden");
      }

      function hideLoadingOverlay() {
        document.getElementById("loading-overlay").classList.add("hidden");
      }

      function showToast(message, type = "info") {
        const toastConfig = {
          text: message,
          duration: 3000,
          gravity: "top",
          position: "right",
          stopOnFocus: true,
          style: {
            background:
              type === "success"
                ? "#4caf50"
                : type === "error"
                ? "#f44336"
                : type === "warning"
                ? "#ff9800"
                : "#2196f3",
            borderRadius: "8px",
            fontFamily: "Inter, sans-serif",
            fontWeight: "500",
          },
        };

        if (typeof Toastify !== "undefined") {
          Toastify(toastConfig).showToast();
        } else {
          console.log(`Toast: ${message} (${type})`);
        }
      }

      // Quick actions functionality
      document.addEventListener("DOMContentLoaded", function () {
        // Additional quick action handlers
        document.querySelectorAll(".quick-action").forEach((button) => {
          button.addEventListener("click", function () {
            const title = this.getAttribute("title");
            if (title.includes("Generate")) {
              generateNewRecommendations();
            } else if (title.includes("Export")) {
              exportRecommendations();
            } else if (title.includes("Assistant")) {
              document.getElementById("chat-input").focus();
            } else {
              showToast(`${title} feature activated!`, "info");
            }
          });
        });
      });

      // Keyboard shortcuts
      document.addEventListener("keydown", function (e) {
        if (e.ctrlKey && e.key === "r") {
          e.preventDefault();
          refreshRecommendations();
        }

        if (e.ctrlKey && e.key === "e") {
          e.preventDefault();
          exportRecommendations();
        }

        if (e.ctrlKey && e.key === "g") {
          e.preventDefault();
          generateNewRecommendations();
        }
      });

      // Performance optimization - intersection observer for animations
      const observerOptions = {
        root: null,
        rootMargin: "50px",
        threshold: 0.1,
      };

      const cardObserver = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.style.opacity = "1";
            entry.target.style.transform = "translateY(0)";
          }
        });
      }, observerOptions);

      // Observe recommendation cards
      document.addEventListener("DOMContentLoaded", function () {
        const cards = document.querySelectorAll(".recommendation-card");
        cards.forEach((card) => {
          cardObserver.observe(card);
        });
      });

      // Error handling
      window.addEventListener("error", function (e) {
        console.error("AI Recommendations Page Error:", e.error);
        showToast("An error occurred. Please refresh the page.", "error");
      });

      // Final initialization check
      document.addEventListener("DOMContentLoaded", function () {
        // Verify all critical elements are loaded
        const criticalElements = [
          "category-filter",
          "confidence-filter",
          "recommendations-grid",
          "performance-chart",
          "chat-messages",
          "chat-input",
        ];

        const missing = criticalElements.filter(
          (id) => !document.getElementById(id)
        );

        if (missing.length > 0) {
          console.warn("Missing critical elements:", missing);
        } else {
          console.log("✅ All critical elements loaded successfully");
        }
      });
    </script>
  </body>
</html>
